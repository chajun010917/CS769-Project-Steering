With steering: J
results['with_steering']['correct']: 0
Evaluating steering:   1%|▌                                                             | 1/100 [00:22<37:03, 22.46s/it]With steering: (2000/35)*(20.0
results['with_steering']['correct']: 0
Evaluating steering:   2%|█▏                                                          | 2/100 [01:10<1:01:06, 37.42s/it]With steering: i
results['with_steering']['correct']: 0
Evaluating steering:   3%|█▊                                                            | 3/100 [01:34<50:44, 31.39s/it]With steering: b
results['with_steering']['correct']: 0
Evaluating steering:   4%|██▍                                                           | 4/100 [01:50<40:33, 25.35s/it]With steering: H
results['with_steering']['correct']: 0
Evaluating steering:   5%|███                                                           | 5/100 [02:02<32:38, 20.62s/it]With steering: (1 -
results['with_steering']['correct']: 0
Evaluating steering:   6%|███▋                                                          | 6/100 [02:50<46:54, 29.94s/it]With steering: F
results['with_steering']['correct']: 0
Evaluating steering:   7%|████▎                                                         | 7/100 [03:14<43:11, 27.87s/it]With steering: I
results['with_steering']['correct']: 0
Evaluating steering:   8%|████▉                                                         | 8/100 [03:22<33:05, 21.58s/it]With steering: **Replacing
results['with_steering']['correct']: 0
Evaluating steering:   9%|█████▌                                                        | 9/100 [04:10<45:17, 29.86s/it]With steering: C1 * (2 * (5 + √21]) + C2 * ( 2 * (5
results['with_steering']['correct']: 0
Evaluating steering:  10%|██████                                                       | 10/100 [04:59<53:23, 35.59s/it]With steering: G
results['with_steering']['correct']: 1
Evaluating steering:  11%|██████▋                                                      | 11/100 [05:09<41:12, 27.79s/it]With steering: B
results['with_steering']['correct']: 2
Evaluating steering:  12%|███████▎                                                     | 12/100 [05:53<48:18, 32.94s/it]With steering: E
results['with_steering']['correct']: 2
Evaluating steering:  13%|███████▉                                                     | 13/100 [06:34<51:03, 35.21s/it]With steering: D
results['with_steering']['correct']: 2
Evaluating steering:  14%|████████▌                                                    | 14/100 [06:48<41:08, 28.71s/it]With steering: Since
results['with_steering']['correct']: 2
Evaluating steering:  15%|█████████▏                                                   | 15/100 [07:35<48:50, 34.48s/it]With steering: E
results['with_steering']['correct']: 3
Evaluating steering:  16%|█████████▊                                                   | 16/100 [07:45<37:51, 27.04s/it]With steering: D
results['with_steering']['correct']: 4
Evaluating steering:  17%|██████████▎                                                  | 17/100 [08:00<32:27, 23.46s/it]With steering: {ans
results['with_steering']['correct']: 4
Evaluating steering:  18%|██████████▉                                                  | 18/100 [08:48<42:11, 30.88s/it]With steering: i
results['with_steering']['correct']: 4
Evaluating steering:  19%|███████████▌                                                 | 19/100 [09:13<38:58, 28.87s/it]With steering: D
results['with_steering']['correct']: 4
Evaluating steering:  20%|████████████▏                                                | 20/100 [09:26<32:26, 24.34s/it]With steering: D
results['with_steering']['correct']: 4
Evaluating steering:  21%|████████████▊                                                | 21/100 [09:52<32:35, 24.75s/it]With steering: i
results['with_steering']['correct']: 4
Evaluating steering:  22%|█████████████▍                                               | 22/100 [10:06<27:54, 21.46s/it]With steering: s
results['with_steering']['correct']: 4
Evaluating steering:  23%|██████████████                                               | 23/100 [10:54<37:47, 29.45s/it]With steering: B
results['with_steering']['correct']: 4
Evaluating steering:  24%|██████████████▋                                              | 24/100 [11:42<44:16, 34.96s/it]With steering: c
results['with_steering']['correct']: 4
Evaluating steering:  25%|███████████████▎                                             | 25/100 [12:30<48:38, 38.92s/it]With steering: C
results['with_steering']['correct']: 5
Evaluating steering:  26%|███████████████▊                                             | 26/100 [12:43<38:15, 31.02s/it]With steering: G
results['with_steering']['correct']: 5
Evaluating steering:  27%|████████████████▍                                            | 27/100 [13:24<41:26, 34.07s/it]With steering: c
results['with_steering']['correct']: 5
Evaluating steering:  28%|█████████████████                                            | 28/100 [13:53<39:03, 32.55s/it]With steering: {
results['with_steering']['correct']: 5
Evaluating steering:  29%|█████████████████▋                                           | 29/100 [14:41<44:00, 37.19s/it]With steering: c
results['with_steering']['correct']: 5
Evaluating steering:  30%|██████████████████▎                                          | 30/100 [15:29<47:15, 40.51s/it]With steering: C
results['with_steering']['correct']: 6
Evaluating steering:  31%|██████████████████▉                                          | 31/100 [15:50<39:44, 34.56s/it]With steering: c
results['with_steering']['correct']: 6
Evaluating steering:  32%|███████████████████▌                                         | 32/100 [16:38<43:49, 38.68s/it]With steering: B
results['with_steering']['correct']: 6
Evaluating steering:  33%|████████████████████▏                                        | 33/100 [17:03<38:32, 34.51s/it]With steering: E
results['with_steering']['correct']: 7
Evaluating steering:  34%|████████████████████▋                                        | 34/100 [17:31<35:53, 32.62s/it]With steering: i
results['with_steering']['correct']: 7
Evaluating steering:  35%|█████████████████████▎                                       | 35/100 [18:19<40:22, 37.27s/it]With steering: (b) 3.572722
results['with_steering']['correct']: 7
Evaluating steering:  36%|█████████████████████▉                                       | 36/100 [18:44<35:41, 33.46s/it]With steering: D
results['with_steering']['correct']: 7
Evaluating steering:  37%|██████████████████████▌                                      | 37/100 [19:05<31:11, 29.70s/it]With steering: D
results['with_steering']['correct']: 7
Evaluating steering:  38%|███████████████████████▏                                     | 38/100 [19:20<26:19, 25.47s/it]With steering: s
results['with_steering']['correct']: 7
Evaluating steering:  39%|███████████████████████▊                                     | 39/100 [20:08<32:45, 32.22s/it]With steering: f
results['with_steering']['correct']: 7
Evaluating steering:  40%|████████████████████████▍                                    | 40/100 [20:28<28:27, 28.46s/it]With steering: G
results['with_steering']['correct']: 7
Evaluating steering:  41%|█████████████████████████                                    | 41/100 [20:48<25:26, 25.88s/it]With steering: E
results['with_steering']['correct']: 8
Evaluating steering:  42%|█████████████████████████▌                                   | 42/100 [20:59<20:41, 21.41s/it]With steering: i
results['with_steering']['correct']: 8
Evaluating steering:  43%|██████████████████████████▏                                  | 43/100 [21:24<21:28, 22.60s/it]With steering: F. False, False
results['with_steering']['correct']: 8
Evaluating steering:  44%|██████████████████████████▊                                  | 44/100 [21:41<19:37, 21.03s/it]With steering: G
results['with_steering']['correct']: 8
Evaluating steering:  45%|███████████████████████████▍                                 | 45/100 [21:54<17:01, 18.56s/it]With steering: C
results['with_steering']['correct']: 8
Evaluating steering:  46%|████████████████████████████                                 | 46/100 [22:32<21:55, 24.36s/it]With steering: G
results['with_steering']['correct']: 9
Evaluating steering:  47%|████████████████████████████▋                                | 47/100 [22:50<19:43, 22.32s/it]With steering: g
results['with_steering']['correct']: 9
Evaluating steering:  48%|█████████████████████████████▎                               | 48/100 [23:14<19:52, 22.93s/it]With steering: The
results['with_steering']['correct']: 9
Evaluating steering:  49%|█████████████████████████████▉                               | 49/100 [23:36<19:15, 22.65s/it]With steering: D
results['with_steering']['correct']: 10
Evaluating steering:  50%|██████████████████████████████▌                              | 50/100 [23:59<18:52, 22.65s/it]With steering: B
results['with_steering']['correct']: 10
Evaluating steering:  51%|███████████████████████████████                              | 51/100 [24:33<21:18, 26.08s/it]With steering: H
results['with_steering']['correct']: 10
Evaluating steering:  52%|███████████████████████████████▋                             | 52/100 [25:02<21:29, 26.87s/it]With steering: - = (-(1 / (8 * 2 * sqrt{2 * π}) * (1 / (sqrt(u)) * (1 / 2 * e^(-ut] * (sin(1 * 2t] + 2 * COS(2 * t]) |{from t
results['with_steering']['correct']: 10
Evaluating steering:  53%|████████████████████████████████▎                            | 53/100 [25:50<26:04, 33.28s/it]With steering: - Now we need an 'y' and a 'z' but there is no  way  to  generate
results['with_steering']['correct']: 10
Evaluating steering:  54%|████████████████████████████████▉                            | 54/100 [26:38<28:53, 37.68s/it]With steering: C
results['with_steering']['correct']: 11
Evaluating steering:  55%|█████████████████████████████████▌                           | 55/100 [27:05<25:48, 34.42s/it]With steering: The deletion of a quadrupplet of nucleotides (option I) would have the greatest deletrious effect as it would almost certainly cause a complete disruption of the reading frame and result in a non-functional protein.
results['with_steering']['correct']: 11
Evaluating steering:  56%|██████████████████████████████████▏                          | 56/100 [27:29<23:07, 31.54s/it]With steering: I
results['with_steering']['correct']: 12
Evaluating steering:  57%|██████████████████████████████████▊                          | 57/100 [27:49<20:05, 28.05s/it]With steering: D
results['with_steering']['correct']: 12
Evaluating steering:  58%|███████████████████████████████████▍                         | 58/100 [28:10<18:11, 26.00s/it]With steering: F
results['with_steering']['correct']: 13
Evaluating steering:  59%|███████████████████████████████████▉                         | 59/100 [28:15<13:21, 19.55s/it]With steering: i
results['with_steering']['correct']: 13
Evaluating steering:  60%|████████████████████████████████████▌                        | 60/100 [28:37<13:34, 20.37s/it]With steering: J
results['with_steering']['correct']: 13
Evaluating steering:  61%|█████████████████████████████████████▏                       | 61/100 [28:58<13:22, 20.57s/it]With steering: F
results['with_steering']['correct']: 13
Evaluating steering:  62%|█████████████████████████████████████▊                       | 62/100 [29:45<18:00, 28.44s/it]With steering: A
results['with_steering']['correct']: 13
Evaluating steering:  63%|██████████████████████████████████████▍                      | 63/100 [30:17<18:08, 29.43s/it]With steering: However, I made another error in my calculations above.
results['with_steering']['correct']: 13
Evaluating steering:  64%|███████████████████████████████████████                      | 64/100 [31:05<21:01, 35.05s/it]With steering: E
results['with_steering']['correct']: 13
Evaluating steering:  65%|███████████████████████████████████████▋                     | 65/100 [31:17<16:21, 28.03s/it]With steering: B
results['with_steering']['correct']: 13
Evaluating steering:  66%|████████████████████████████████████████▎                    | 66/100 [31:33<13:54, 24.54s/it]With steering: D
results['with_steering']['correct']: 13
Evaluating steering:  67%|████████████████████████████████████████▊                    | 67/100 [31:53<12:48, 23.30s/it]With steering: H
results['with_steering']['correct']: 14
Evaluating steering:  68%|█████████████████████████████████████████▍                   | 68/100 [32:17<12:26, 23.33s/it]With steering: B
results['with_steering']['correct']: 14
Evaluating steering:  69%|██████████████████████████████████████████                   | 69/100 [32:51<13:45, 26.63s/it]With steering: B
results['with_steering']['correct']: 14
Evaluating steering:  70%|██████████████████████████████████████████▋                  | 70/100 [33:39<16:32, 33.07s/it]With steering: B
results['with_steering']['correct']: 14
Evaluating steering:  71%|███████████████████████████████████████████▎                 | 71/100 [34:02<14:24, 29.83s/it]With steering: D
results['with_steering']['correct']: 14
Evaluating steering:  72%|███████████████████████████████████████████▉                 | 72/100 [34:11<11:06, 23.82s/it]With steering: H
results['with_steering']['correct']: 15
Evaluating steering:  73%|████████████████████████████████████████████▌                | 73/100 [34:26<09:29, 21.09s/it]With steering: B
results['with_steering']['correct']: 15
Evaluating steering:  74%|█████████████████████████████████████████████▏               | 74/100 [35:05<11:29, 26.52s/it]With steering: G
results['with_steering']['correct']: 15
Evaluating steering:  75%|█████████████████████████████████████████████▊               | 75/100 [35:31<10:54, 26.16s/it]With steering: b
results['with_steering']['correct']: 15
Evaluating steering:  76%|██████████████████████████████████████████████▎              | 76/100 [35:49<09:29, 23.74s/it]With steering: H
results['with_steering']['correct']: 15
Evaluating steering:  77%|██████████████████████████████████████████████▉              | 77/100 [36:01<07:49, 20.41s/it]With steering: B
results['with_steering']['correct']: 16
Evaluating steering:  78%|███████████████████████████████████████████████▌             | 78/100 [36:11<06:18, 17.18s/it]With steering: **
results['with_steering']['correct']: 16
Evaluating steering:  79%|████████████████████████████████████████████████▏            | 79/100 [36:59<09:17, 26.54s/it]With steering: i
results['with_steering']['correct']: 16
Evaluating steering:  80%|████████████████████████████████████████████████▊            | 80/100 [37:25<08:46, 26.31s/it]With steering: b
results['with_steering']['correct']: 16
Evaluating steering:  81%|█████████████████████████████████████████████████▍           | 81/100 [38:13<10:24, 32.88s/it]With steering: B
results['with_steering']['correct']: 16
Evaluating steering:  82%|██████████████████████████████████████████████████           | 82/100 [38:37<09:01, 30.10s/it]With steering: i
results['with_steering']['correct']: 16
Evaluating steering:  83%|██████████████████████████████████████████████████▋          | 83/100 [39:25<10:02, 35.47s/it]With steering: A
results['with_steering']['correct']: 17
Evaluating steering:  84%|███████████████████████████████████████████████████▏         | 84/100 [40:06<09:52, 37.04s/it]With steering: - Proceeds =
results['with_steering']['correct']: 17
Evaluating steering:  85%|███████████████████████████████████████████████████▊         | 85/100 [40:54<10:05, 40.34s/it]With steering: F
results['with_steering']['correct']: 17
Evaluating steering:  86%|████████████████████████████████████████████████████▍        | 86/100 [41:09<07:40, 32.87s/it]With steering: A
results['with_steering']['correct']: 18
Evaluating steering:  87%|█████████████████████████████████████████████████████        | 87/100 [41:17<05:31, 25.47s/it]With steering: C
results['with_steering']['correct']: 19
Evaluating steering:  88%|█████████████████████████████████████████████████████▋       | 88/100 [41:33<04:29, 22.43s/it]With steering: A
results['with_steering']['correct']: 19
Evaluating steering:  89%|██████████████████████████████████████████████████████▎      | 89/100 [42:00<04:22, 23.83s/it]With steering: A
results['with_steering']['correct']: 19
Evaluating steering:  90%|██████████████████████████████████████████████████████▉      | 90/100 [42:13<03:26, 20.61s/it]With steering: s
results['with_steering']['correct']: 19
Evaluating steering:  91%|███████████████████████████████████████████████████████▌     | 91/100 [42:37<03:16, 21.82s/it]With steering: H
results['with_steering']['correct']: 20
Evaluating steering:  92%|████████████████████████████████████████████████████████     | 92/100 [43:10<03:19, 24.90s/it]With steering: J
results['with_steering']['correct']: 21
Evaluating steering:  93%|████████████████████████████████████████████████████████▋    | 93/100 [43:34<02:52, 24.66s/it]With steering: = 5.67*10
results['with_steering']['correct']: 21
Evaluating steering:  94%|█████████████████████████████████████████████████████████▎   | 94/100 [44:22<03:10, 31.75s/it]With steering: should
results['with_steering']['correct']: 21
Evaluating steering:  95%|█████████████████████████████████████████████████████████▉   | 95/100 [44:40<02:18, 27.63s/it]With steering: H
results['with_steering']['correct']: 21
Evaluating steering:  96%|██████████████████████████████████████████████████████████▌  | 96/100 [44:55<01:34, 23.73s/it]With steering: C
results['with_steering']['correct']: 22
Evaluating steering:  97%|███████████████████████████████████████████████████████████▏ | 97/100 [45:11<01:04, 21.49s/it]With steering: N { u _ { x ] = 0. {.  3 2 2 ] \cdot R e _ {
results['with_steering']['correct']: 22
Evaluating steering:  98%|███████████████████████████████████████████████████████████▊ | 98/100 [46:00<00:59, 29.69s/it]With steering: H
results['with_steering']['correct']: 23
Evaluating steering:  99%|████████████████████████████████████████████████████████████▍| 99/100 [46:16<00:25, 25.63s/it]With steering: E
results['with_steering']['correct']: 24
Evaluating steering: 100%|████████████████████████████████████████████████████████████| 100/100 [46:36<00:00, 27.96s/it]
2025-11-09 23:38:27,952 | INFO | Saved evaluation results to artifacts/steering_evaluation/steering_evaluation_results.json
2025-11-09 23:38:27,953 | INFO | ============================================================
2025-11-09 23:38:27,953 | INFO | Steering Evaluation Results
2025-11-09 23:38:27,953 | INFO | ============================================================
2025-11-09 23:38:27,953 | INFO | Total triples evaluated: 100
2025-11-09 23:38:27,953 | INFO |
2025-11-09 23:38:27,953 | INFO | Without steering (from provided baseline):
2025-11-09 23:38:27,953 | INFO |   Correct: 8
2025-11-09 23:38:27,953 | INFO |   Incorrect: 92
2025-11-09 23:38:27,953 | INFO |   Accuracy: 8.00%
2025-11-09 23:38:27,953 | INFO |
2025-11-09 23:38:27,953 | INFO | With steering (coefficient=1.00):
2025-11-09 23:38:27,953 | INFO |   Correct: 24
2025-11-09 23:38:27,953 | INFO |   Incorrect: 76
2025-11-09 23:38:27,953 | INFO |   Accuracy: 24.00%
2025-11-09 23:38:27,953 | INFO |
2025-11-09 23:38:27,953 | INFO | Accuracy change (vs. baseline): +16.00%
2025-11-09 23:38:27,953 | INFO | (Improvements/degradations not tracked when baseline is skipped)
2025-11-09 23:38:27,953 | INFO | ============================================================
Steering evaluation complete. Results saved to artifacts/steering_evaluation
=== Step 8: Comparing embeddings with and without steering ===
Comparing embeddings for layer 26...
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/transformers/utils/hub.py:127: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
2025-11-09 23:39:18,220 | INFO | Loaded 100 triples for comparison
2025-11-09 23:39:18,221 | INFO | Loaded steering vector for layer 26 (shape: (4096,), norm: 21.9844)
2025-11-09 23:39:18,416 | INFO | Loading model meta-llama/Llama-3.1-8B-Instruct on cuda with dtype torch.float16
Downloading shards: 100%|███████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 1106.60it/s]
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.61s/it]
2025-11-09 23:39:27,190 | INFO | Collecting hidden states without steering...
Collecting hidden states: 100%|███████████████████████████████████████████████████████| 100/100 [00:19<00:00,  5.11it/s]
2025-11-09 23:39:46,758 | INFO | Collected 100 embeddings without steering (shape: (100, 4096))
2025-11-09 23:39:46,758 | INFO | Collecting hidden states with steering (simulated by adding steering vector)...
Collecting hidden states: 100%|███████████████████████████████████████████████████████| 100/100 [00:18<00:00,  5.29it/s]
2025-11-09 23:40:05,656 | INFO | Collected 100 embeddings with steering (shape: (100, 4096))
2025-11-09 23:40:05,673 | INFO | Shift statistics:
2025-11-09 23:40:05,673 | INFO |   Mean L2 shift: 21.9844 ± 0.0000
2025-11-09 23:40:05,673 | INFO |   Median L2 shift: 21.9844
2025-11-09 23:40:05,673 | INFO |   Max L2 shift: 21.9844
2025-11-09 23:40:05,673 | INFO |   Mean cosine similarity: 0.6426 ± 0.0163
2025-11-09 23:40:05,673 | INFO |   Min cosine similarity: 0.6092
2025-11-09 23:40:05,736 | INFO | Saved statistics to reports/steering_embedding_comparison/layer26_shift_statistics.json
2025-11-09 23:40:05,737 | INFO | Creating visualizations...
2025-11-09 23:40:08,326 | INFO | Saved comparison plot to reports/steering_embedding_comparison/layer26_pca_comparison.png
2025-11-09 23:40:09,036 | INFO | Saved overlay plot to reports/steering_embedding_comparison/layer26_pca_overlay.png
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/numba/np/ufunc/parallel.py:373: NumbaWarning: The TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.
  warnings.warn(problem)
2025-11-09 23:40:19,016 | INFO | Saved comparison plot to reports/steering_embedding_comparison/layer26_umap_comparison.png
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
2025-11-09 23:40:20,044 | INFO | Saved overlay plot to reports/steering_embedding_comparison/layer26_umap_overlay.png
2025-11-09 23:40:20,044 | INFO | All visualizations saved to reports/steering_embedding_comparison
Embedding comparison complete. Results saved to reports/steering_embedding_comparison

=== Done! ===
Results:
  - Triples: artifacts/triples/triples_small.jsonl
  - Hidden states: artifacts/hidden_states/
  - Alignments: artifacts/alignments/
  - Probe data: artifacts/probe_data/
./run.bash: line 257: ANALYSIS_OUTPUT: unbound variable