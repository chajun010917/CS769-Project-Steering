=== Step 1: Using manually reviewed triples: ./artifacts/manual_review/12062025_human_review.json ===
=== Step 2: Skipping hidden state capture (SKIP_HIDDEN=1) ===
=== Step 3: Skipping probe computation (SKIP_PROBES=1) ===
=== Step 4: Generating visualizations ===
  Plotting layer 26...
2025-12-11 20:53:18,065 | INFO | Loading PCA data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer26_pca_data.npz
2025-12-11 20:53:18,090 | INFO | PCA DP filter retained 1336 samples
2025-12-11 20:53:18,096 | INFO | Applying DP tail filter to PCA data (retained 446 samples).
2025-12-11 20:53:18,368 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer26_pca_clusters_dp.png
2025-12-11 20:53:18,368 | INFO | Loading UMAP data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer26_umap_data.npz
2025-12-11 20:53:18,369 | INFO | UMAP DP filter retained 1336 samples
2025-12-11 20:53:18,369 | INFO | Applying DP tail filter to UMAP data (retained 446 samples).
2025-12-11 20:53:18,612 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer26_umap_clusters_dp.png
2025-12-11 20:53:18,613 | INFO | All plots saved to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token
  Plotting layer 27...
2025-12-11 20:53:19,210 | INFO | Loading PCA data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer27_pca_data.npz
2025-12-11 20:53:19,212 | INFO | PCA DP filter retained 1336 samples
2025-12-11 20:53:19,218 | INFO | Applying DP tail filter to PCA data (retained 446 samples).
2025-12-11 20:53:19,500 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer27_pca_clusters_dp.png
2025-12-11 20:53:19,500 | INFO | Loading UMAP data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer27_umap_data.npz
2025-12-11 20:53:19,501 | INFO | UMAP DP filter retained 1336 samples
2025-12-11 20:53:19,501 | INFO | Applying DP tail filter to UMAP data (retained 446 samples).
2025-12-11 20:53:19,752 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer27_umap_clusters_dp.png
2025-12-11 20:53:19,752 | INFO | All plots saved to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token
  Plotting layer 28...
2025-12-11 20:53:20,354 | INFO | Loading PCA data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer28_pca_data.npz
2025-12-11 20:53:20,356 | INFO | PCA DP filter retained 1336 samples
2025-12-11 20:53:20,361 | INFO | Applying DP tail filter to PCA data (retained 446 samples).
2025-12-11 20:53:20,639 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer28_pca_clusters_dp.png
2025-12-11 20:53:20,639 | INFO | Loading UMAP data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer28_umap_data.npz
2025-12-11 20:53:20,640 | INFO | UMAP DP filter retained 1336 samples
2025-12-11 20:53:20,640 | INFO | Applying DP tail filter to UMAP data (retained 446 samples).
2025-12-11 20:53:20,867 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer28_umap_clusters_dp.png
2025-12-11 20:53:20,867 | INFO | All plots saved to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token
  Plotting layer 29...
2025-12-11 20:53:21,467 | INFO | Loading PCA data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer29_pca_data.npz
2025-12-11 20:53:21,469 | INFO | PCA DP filter retained 1336 samples
2025-12-11 20:53:21,475 | INFO | Applying DP tail filter to PCA data (retained 446 samples).
2025-12-11 20:53:21,759 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer29_pca_clusters_dp.png
2025-12-11 20:53:21,760 | INFO | Loading UMAP data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer29_umap_data.npz
2025-12-11 20:53:21,760 | INFO | UMAP DP filter retained 1336 samples
2025-12-11 20:53:21,760 | INFO | Applying DP tail filter to UMAP data (retained 446 samples).
2025-12-11 20:53:21,991 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer29_umap_clusters_dp.png
2025-12-11 20:53:21,991 | INFO | All plots saved to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token
  Plotting layer 30...
2025-12-11 20:53:22,570 | INFO | Loading PCA data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer30_pca_data.npz
2025-12-11 20:53:22,572 | INFO | PCA DP filter retained 1336 samples
2025-12-11 20:53:22,577 | INFO | Applying DP tail filter to PCA data (retained 446 samples).
2025-12-11 20:53:22,867 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer30_pca_clusters_dp.png
2025-12-11 20:53:22,868 | INFO | Loading UMAP data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer30_umap_data.npz
2025-12-11 20:53:22,868 | INFO | UMAP DP filter retained 1336 samples
2025-12-11 20:53:22,868 | INFO | Applying DP tail filter to UMAP data (retained 446 samples).
2025-12-11 20:53:23,088 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer30_umap_clusters_dp.png
2025-12-11 20:53:23,088 | INFO | All plots saved to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token
  Plotting layer 31...
2025-12-11 20:53:23,682 | INFO | Loading PCA data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer31_pca_data.npz
2025-12-11 20:53:23,684 | INFO | PCA DP filter retained 1336 samples
2025-12-11 20:53:23,690 | INFO | Applying DP tail filter to PCA data (retained 446 samples).
2025-12-11 20:53:23,973 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer31_pca_clusters_dp.png
2025-12-11 20:53:23,973 | INFO | Loading UMAP data from /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/layer31_umap_data.npz
2025-12-11 20:53:23,974 | INFO | UMAP DP filter retained 1336 samples
2025-12-11 20:53:23,974 | INFO | Applying DP tail filter to UMAP data (retained 446 samples).
2025-12-11 20:53:24,229 | INFO | Saved cluster overlay to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/cluster_overlays_dp/layer31_umap_clusters_dp.png
2025-12-11 20:53:24,229 | INFO | All plots saved to /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token
=== Step 5: Skipping critical token analysis (SKIP_CRITICAL=1) ===
=== Step 6: Computing steering vectors from last_token representations ===
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/transformers/utils/hub.py:127: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
2025-12-11 20:53:26,372 | INFO | Loaded 100 triples
2025-12-11 20:53:26,372 | INFO | Target layers for steering vector computation: [26, 27, 28, 29, 30, 31]
2025-12-11 20:53:26,571 | INFO | Loading model meta-llama/Llama-3.1-8B-Instruct on cuda with dtype torch.float16
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 14376.36it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:06,  2.08s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.09s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:06<00:02,  2.07s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.46s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.69s/it]
Computing steering vectors:   0%|          | 0/100 [00:00<?, ?it/s]Computing steering vectors:   1%|          | 1/100 [00:01<02:44,  1.66s/it]Computing steering vectors:   2%|▏         | 2/100 [00:02<02:01,  1.24s/it]Computing steering vectors:   3%|▎         | 3/100 [00:03<01:33,  1.03it/s]Computing steering vectors:   4%|▍         | 4/100 [00:03<01:12,  1.32it/s]Computing steering vectors:   5%|▌         | 5/100 [00:04<01:25,  1.11it/s]Computing steering vectors:   6%|▌         | 6/100 [00:06<01:48,  1.16s/it]Computing steering vectors:   7%|▋         | 7/100 [00:07<01:39,  1.07s/it]Computing steering vectors:   8%|▊         | 8/100 [00:08<01:26,  1.07it/s]Computing steering vectors:   9%|▉         | 9/100 [00:08<01:12,  1.26it/s]Computing steering vectors:  10%|█         | 10/100 [00:09<01:12,  1.23it/s]Computing steering vectors:  11%|█         | 11/100 [00:10<01:09,  1.28it/s]Computing steering vectors:  12%|█▏        | 12/100 [00:10<01:01,  1.43it/s]Computing steering vectors:  13%|█▎        | 13/100 [00:11<01:10,  1.24it/s]Computing steering vectors:  14%|█▍        | 14/100 [00:13<01:29,  1.04s/it]Computing steering vectors:  15%|█▌        | 15/100 [00:14<01:41,  1.19s/it]Computing steering vectors:  16%|█▌        | 16/100 [00:16<01:44,  1.25s/it]Computing steering vectors:  17%|█▋        | 17/100 [00:17<01:39,  1.19s/it]Computing steering vectors:  18%|█▊        | 18/100 [00:18<01:29,  1.09s/it]Computing steering vectors:  19%|█▉        | 19/100 [00:18<01:15,  1.07it/s]Computing steering vectors:  20%|██        | 20/100 [00:20<01:28,  1.11s/it]Computing steering vectors:  21%|██        | 21/100 [00:20<01:20,  1.02s/it]Computing steering vectors:  22%|██▏       | 22/100 [00:21<01:15,  1.03it/s]Computing steering vectors:  23%|██▎       | 23/100 [00:22<01:11,  1.08it/s]Computing steering vectors:  24%|██▍       | 24/100 [00:23<01:03,  1.19it/s]Computing steering vectors:  25%|██▌       | 25/100 [00:24<01:09,  1.07it/s]Computing steering vectors:  26%|██▌       | 26/100 [00:25<01:07,  1.09it/s]Computing steering vectors:  27%|██▋       | 27/100 [00:25<00:58,  1.26it/s]Computing steering vectors:  28%|██▊       | 28/100 [00:26<01:01,  1.18it/s]Computing steering vectors:  29%|██▉       | 29/100 [00:27<00:58,  1.21it/s]Computing steering vectors:  30%|███       | 30/100 [00:28<00:58,  1.20it/s]Computing steering vectors:  31%|███       | 31/100 [00:29<01:07,  1.02it/s]Computing steering vectors:  32%|███▏      | 32/100 [00:31<01:12,  1.07s/it]Computing steering vectors:  33%|███▎      | 33/100 [00:32<01:13,  1.09s/it]Computing steering vectors:  34%|███▍      | 34/100 [00:32<01:03,  1.04it/s]Computing steering vectors:  35%|███▌      | 35/100 [00:33<00:57,  1.13it/s]Computing steering vectors:  36%|███▌      | 36/100 [00:34<00:57,  1.12it/s]Computing steering vectors:  37%|███▋      | 37/100 [00:36<01:09,  1.10s/it]Computing steering vectors:  38%|███▊      | 38/100 [00:37<01:07,  1.08s/it]Computing steering vectors:  39%|███▉      | 39/100 [00:37<01:01,  1.01s/it]Computing steering vectors:  40%|████      | 40/100 [00:39<01:03,  1.06s/it]Computing steering vectors:  41%|████      | 41/100 [00:39<00:54,  1.09it/s]Computing steering vectors:  42%|████▏     | 42/100 [00:40<00:52,  1.10it/s]Computing steering vectors:  43%|████▎     | 43/100 [00:42<01:03,  1.12s/it]Computing steering vectors:  44%|████▍     | 44/100 [00:42<00:53,  1.05it/s]Computing steering vectors:  45%|████▌     | 45/100 [00:43<00:56,  1.02s/it]Computing steering vectors:  46%|████▌     | 46/100 [00:44<00:50,  1.08it/s]Computing steering vectors:  47%|████▋     | 47/100 [00:45<00:45,  1.16it/s]Computing steering vectors:  48%|████▊     | 48/100 [00:46<00:51,  1.01it/s]Computing steering vectors:  49%|████▉     | 49/100 [00:47<00:44,  1.14it/s]Computing steering vectors:  50%|█████     | 50/100 [00:48<00:52,  1.04s/it]Computing steering vectors:  51%|█████     | 51/100 [00:50<00:57,  1.18s/it]Computing steering vectors:  52%|█████▏    | 52/100 [00:51<00:57,  1.20s/it]Computing steering vectors:  53%|█████▎    | 53/100 [00:52<01:00,  1.28s/it]Computing steering vectors:  54%|█████▍    | 54/100 [00:53<00:55,  1.21s/it]Computing steering vectors:  55%|█████▌    | 55/100 [00:54<00:50,  1.12s/it]Computing steering vectors:  56%|█████▌    | 56/100 [00:55<00:47,  1.07s/it]Computing steering vectors:  57%|█████▋    | 57/100 [00:58<01:03,  1.48s/it]Computing steering vectors:  58%|█████▊    | 58/100 [01:00<01:08,  1.63s/it]Computing steering vectors:  59%|█████▉    | 59/100 [01:00<00:52,  1.28s/it]Computing steering vectors:  60%|██████    | 60/100 [01:01<00:43,  1.09s/it]Computing steering vectors:  61%|██████    | 61/100 [01:02<00:42,  1.08s/it]Computing steering vectors:  62%|██████▏   | 62/100 [01:03<00:40,  1.05s/it]Computing steering vectors:  63%|██████▎   | 63/100 [01:04<00:43,  1.18s/it]Computing steering vectors:  64%|██████▍   | 64/100 [01:05<00:39,  1.11s/it]Computing steering vectors:  65%|██████▌   | 65/100 [01:07<00:40,  1.15s/it]Computing steering vectors:  66%|██████▌   | 66/100 [01:07<00:32,  1.04it/s]Computing steering vectors:  67%|██████▋   | 67/100 [01:08<00:36,  1.10s/it]Computing steering vectors:  68%|██████▊   | 68/100 [01:10<00:36,  1.14s/it]Computing steering vectors:  69%|██████▉   | 69/100 [01:11<00:40,  1.30s/it]Computing steering vectors:  70%|███████   | 70/100 [01:12<00:32,  1.09s/it]Computing steering vectors:  71%|███████   | 71/100 [01:14<00:38,  1.34s/it]Computing steering vectors:  72%|███████▏  | 72/100 [01:16<00:44,  1.59s/it]Computing steering vectors:  73%|███████▎  | 73/100 [01:17<00:36,  1.34s/it]Computing steering vectors:  74%|███████▍  | 74/100 [01:18<00:34,  1.34s/it]Computing steering vectors:  75%|███████▌  | 75/100 [01:19<00:30,  1.23s/it]Computing steering vectors:  76%|███████▌  | 76/100 [01:20<00:26,  1.09s/it]Computing steering vectors:  77%|███████▋  | 77/100 [01:21<00:22,  1.03it/s]Computing steering vectors:  78%|███████▊  | 78/100 [01:22<00:23,  1.05s/it]Computing steering vectors:  79%|███████▉  | 79/100 [01:22<00:19,  1.07it/s]Computing steering vectors:  80%|████████  | 80/100 [01:24<00:21,  1.08s/it]Computing steering vectors:  81%|████████  | 81/100 [01:25<00:22,  1.17s/it]Computing steering vectors:  82%|████████▏ | 82/100 [01:26<00:18,  1.05s/it]Computing steering vectors:  83%|████████▎ | 83/100 [01:27<00:15,  1.11it/s]Computing steering vectors:  84%|████████▍ | 84/100 [01:27<00:13,  1.22it/s]Computing steering vectors:  85%|████████▌ | 85/100 [01:28<00:11,  1.29it/s]Computing steering vectors:  86%|████████▌ | 86/100 [01:29<00:12,  1.13it/s]Computing steering vectors:  87%|████████▋ | 87/100 [01:30<00:11,  1.10it/s]Computing steering vectors:  88%|████████▊ | 88/100 [01:32<00:13,  1.09s/it]Computing steering vectors:  89%|████████▉ | 89/100 [01:33<00:11,  1.06s/it]Computing steering vectors:  90%|█████████ | 90/100 [01:34<00:11,  1.12s/it]Computing steering vectors:  91%|█████████ | 91/100 [01:35<00:09,  1.01s/it]Computing steering vectors:  92%|█████████▏| 92/100 [01:35<00:07,  1.10it/s]Computing steering vectors:  93%|█████████▎| 93/100 [01:36<00:06,  1.15it/s]Computing steering vectors:  94%|█████████▍| 94/100 [01:37<00:05,  1.04it/s]Computing steering vectors:  95%|█████████▌| 95/100 [01:38<00:04,  1.04it/s]Computing steering vectors:  96%|█████████▌| 96/100 [01:39<00:04,  1.01s/it]Computing steering vectors:  97%|█████████▋| 97/100 [01:40<00:03,  1.03s/it]Computing steering vectors:  98%|█████████▊| 98/100 [01:41<00:01,  1.01it/s]Computing steering vectors:  99%|█████████▉| 99/100 [01:42<00:00,  1.04it/s]Computing steering vectors: 100%|██████████| 100/100 [01:43<00:00,  1.14it/s]Computing steering vectors: 100%|██████████| 100/100 [01:43<00:00,  1.03s/it]
2025-12-11 20:55:19,023 | INFO | Processed 100 triples (skipped 0, gradient fallbacks 0, DP attempts 522, successes 522, lookup misses 0, DP fallbacks 0, unavailable 0, missing files 0)
2025-12-11 20:55:19,024 | INFO | Layer 26: Computed steering vector from 100 samples (shape: (4096,), norm: 2.8681)
2025-12-11 20:55:19,025 | INFO | Saved steering vector for layer 26 to /nobackup/bdeka/huggingface_cache/artifacts/steering_vectors/layer26_steering_vector.npy
2025-12-11 20:55:19,026 | INFO | Layer 27: Computed steering vector from 100 samples (shape: (4096,), norm: 3.0639)
2025-12-11 20:55:19,026 | INFO | Saved steering vector for layer 27 to /nobackup/bdeka/huggingface_cache/artifacts/steering_vectors/layer27_steering_vector.npy
2025-12-11 20:55:19,027 | INFO | Layer 28: Computed steering vector from 100 samples (shape: (4096,), norm: 3.3029)
2025-12-11 20:55:19,027 | INFO | Saved steering vector for layer 28 to /nobackup/bdeka/huggingface_cache/artifacts/steering_vectors/layer28_steering_vector.npy
2025-12-11 20:55:19,028 | INFO | Layer 29: Computed steering vector from 100 samples (shape: (4096,), norm: 3.6889)
2025-12-11 20:55:19,028 | INFO | Saved steering vector for layer 29 to /nobackup/bdeka/huggingface_cache/artifacts/steering_vectors/layer29_steering_vector.npy
2025-12-11 20:55:19,029 | INFO | Layer 30: Computed steering vector from 100 samples (shape: (4096,), norm: 4.6805)
2025-12-11 20:55:19,029 | INFO | Saved steering vector for layer 30 to /nobackup/bdeka/huggingface_cache/artifacts/steering_vectors/layer30_steering_vector.npy
2025-12-11 20:55:19,030 | INFO | Layer 31: Computed steering vector from 100 samples (shape: (4096,), norm: 18.2167)
2025-12-11 20:55:19,030 | INFO | Saved steering vector for layer 31 to /nobackup/bdeka/huggingface_cache/artifacts/steering_vectors/layer31_steering_vector.npy
2025-12-11 20:55:19,031 | INFO | Saved metadata to /nobackup/bdeka/huggingface_cache/artifacts/steering_vectors/steering_vectors_metadata.json
2025-12-11 20:55:19,032 | INFO | Steering vector computation complete!
=== Step 7: Evaluating steering vectors ===
Evaluating steering for layer 29...
Evaluating in-sample steering performance...
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/transformers/utils/hub.py:127: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
2025-12-11 20:55:23,231 | INFO | Loaded 100 triples for evaluation
2025-12-11 20:55:23,232 | INFO | Loaded steering vector for layer 29 (shape: (4096,), norm: 3.6889)
2025-12-11 20:55:23,423 | INFO | Loading model meta-llama/Llama-3.1-8B-Instruct on cuda with dtype torch.float16
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 13241.69it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:06,  2.08s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.09s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:06<00:02,  2.08s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.46s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:06<00:00,  1.69s/it]
Evaluating steering:   0%|          | 0/100 [00:00<?, ?it/s]/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:567: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
Evaluating steering:   1%|          | 1/100 [00:19<32:58, 19.98s/it]Evaluating steering:   2%|▏         | 2/100 [00:56<48:19, 29.58s/it]Evaluating steering:   3%|▎         | 3/100 [01:42<59:56, 37.08s/it]Evaluating steering:   4%|▍         | 4/100 [02:09<53:07, 33.20s/it]Evaluating steering:   5%|▌         | 5/100 [02:37<49:37, 31.34s/it]Evaluating steering:   6%|▌         | 6/100 [03:36<1:03:40, 40.64s/it]Evaluating steering:   7%|▋         | 7/100 [04:08<58:44, 37.90s/it]  Evaluating steering:   8%|▊         | 8/100 [04:34<52:08, 34.00s/it]Evaluating steering:   9%|▉         | 9/100 [05:07<51:07, 33.71s/it]Evaluating steering:  10%|█         | 10/100 [05:46<53:11, 35.46s/it]Evaluating steering:  11%|█         | 11/100 [06:11<47:56, 32.33s/it]Evaluating steering:  12%|█▏        | 12/100 [06:39<45:10, 30.80s/it]Evaluating steering:  13%|█▎        | 13/100 [08:01<1:07:19, 46.43s/it]Evaluating steering:  14%|█▍        | 14/100 [09:27<1:23:43, 58.41s/it]Evaluating steering:  15%|█▌        | 15/100 [11:01<1:38:00, 69.19s/it]Evaluating steering:  16%|█▌        | 16/100 [12:35<1:47:08, 76.53s/it]Evaluating steering:  17%|█▋        | 17/100 [13:17<1:31:39, 66.26s/it]Evaluating steering:  18%|█▊        | 18/100 [13:52<1:17:34, 56.76s/it]Evaluating steering:  19%|█▉        | 19/100 [14:16<1:03:14, 46.84s/it]Evaluating steering:  20%|██        | 20/100 [15:49<1:21:14, 60.93s/it]Evaluating steering:  21%|██        | 21/100 [16:29<1:11:45, 54.50s/it]Evaluating steering:  22%|██▏       | 22/100 [17:02<1:02:26, 48.03s/it]Evaluating steering:  23%|██▎       | 23/100 [17:46<1:00:18, 47.00s/it]Evaluating steering:  24%|██▍       | 24/100 [18:09<50:22, 39.76s/it]  Evaluating steering:  25%|██▌       | 25/100 [18:39<45:50, 36.67s/it]Evaluating steering:  26%|██▌       | 26/100 [19:03<40:28, 32.82s/it]Evaluating steering:  27%|██▋       | 27/100 [19:23<35:27, 29.15s/it]Evaluating steering:  28%|██▊       | 28/100 [20:09<41:06, 34.26s/it]Evaluating steering:  29%|██▉       | 29/100 [20:40<39:24, 33.30s/it]Evaluating steering:  30%|███       | 30/100 [21:25<42:43, 36.62s/it]Evaluating steering:  31%|███       | 31/100 [22:43<56:33, 49.18s/it]Evaluating steering:  32%|███▏      | 32/100 [23:26<53:35, 47.29s/it]Evaluating steering:  33%|███▎      | 33/100 [24:13<52:35, 47.09s/it]Evaluating steering:  34%|███▍      | 34/100 [24:50<48:41, 44.26s/it]Evaluating steering:  35%|███▌      | 35/100 [25:29<46:10, 42.63s/it]Evaluating steering:  36%|███▌      | 36/100 [26:10<44:56, 42.13s/it]Evaluating steering:  37%|███▋      | 37/100 [26:50<43:23, 41.33s/it]Evaluating steering:  38%|███▊      | 38/100 [28:20<58:00, 56.13s/it]Evaluating steering:  39%|███▉      | 39/100 [29:09<54:54, 54.01s/it]Evaluating steering:  40%|████      | 40/100 [29:59<52:45, 52.75s/it]Evaluating steering:  41%|████      | 41/100 [30:28<44:50, 45.60s/it]Evaluating steering:  42%|████▏     | 42/100 [30:57<39:16, 40.62s/it]Evaluating steering:  43%|████▎     | 43/100 [31:56<43:53, 46.20s/it]Evaluating steering:  44%|████▍     | 44/100 [32:36<41:16, 44.22s/it]Evaluating steering:  45%|████▌     | 45/100 [33:33<44:01, 48.03s/it]Evaluating steering:  46%|████▌     | 46/100 [34:22<43:29, 48.32s/it]Evaluating steering:  47%|████▋     | 47/100 [34:53<38:06, 43.14s/it]Evaluating steering:  48%|████▊     | 48/100 [35:39<38:06, 43.98s/it]Evaluating steering:  49%|████▉     | 49/100 [36:23<37:26, 44.04s/it]Evaluating steering:  50%|█████     | 50/100 [37:49<47:10, 56.61s/it]Evaluating steering:  51%|█████     | 51/100 [39:27<56:16, 68.92s/it]Evaluating steering:  52%|█████▏    | 52/100 [41:15<1:04:29, 80.60s/it]Evaluating steering:  53%|█████▎    | 53/100 [42:28<1:01:25, 78.41s/it]Evaluating steering:  54%|█████▍    | 54/100 [43:04<50:23, 65.73s/it]  Evaluating steering:  55%|█████▌    | 55/100 [43:37<41:57, 55.93s/it]Evaluating steering:  56%|█████▌    | 56/100 [44:28<39:53, 54.39s/it]Evaluating steering:  57%|█████▋    | 57/100 [46:12<49:39, 69.30s/it]Evaluating steering:  58%|█████▊    | 58/100 [48:07<58:11, 83.13s/it]Evaluating steering:  59%|█████▉    | 59/100 [48:32<44:52, 65.68s/it]Evaluating steering:  60%|██████    | 60/100 [48:57<35:30, 53.27s/it]Evaluating steering:  61%|██████    | 61/100 [49:39<32:33, 50.08s/it]Evaluating steering:  62%|██████▏   | 62/100 [50:16<29:15, 46.20s/it]Evaluating steering:  63%|██████▎   | 63/100 [51:20<31:47, 51.57s/it]Evaluating steering:  64%|██████▍   | 64/100 [51:51<27:04, 45.13s/it]Evaluating steering:  65%|██████▌   | 65/100 [52:19<23:26, 40.20s/it]Evaluating steering:  66%|██████▌   | 66/100 [52:56<22:08, 39.08s/it]Evaluating steering:  67%|██████▋   | 67/100 [54:09<27:10, 49.40s/it]Evaluating steering:  68%|██████▊   | 68/100 [54:57<26:08, 49.03s/it]Evaluating steering:  69%|██████▉   | 69/100 [55:35<23:31, 45.54s/it]Evaluating steering:  70%|███████   | 70/100 [56:17<22:17, 44.59s/it]Evaluating steering:  71%|███████   | 71/100 [57:46<27:57, 57.86s/it]Evaluating steering:  72%|███████▏  | 72/100 [59:20<32:00, 68.59s/it]Evaluating steering:  73%|███████▎  | 73/100 [59:52<26:01, 57.82s/it]Evaluating steering:  74%|███████▍  | 74/100 [1:00:42<24:01, 55.46s/it]Evaluating steering:  75%|███████▌  | 75/100 [1:01:53<25:02, 60.08s/it]Evaluating steering:  76%|███████▌  | 76/100 [1:02:38<22:12, 55.50s/it]Evaluating steering:  77%|███████▋  | 77/100 [1:03:21<19:47, 51.63s/it]Evaluating steering:  78%|███████▊  | 78/100 [1:04:31<20:58, 57.19s/it]Evaluating steering:  79%|███████▉  | 79/100 [1:05:13<18:30, 52.87s/it]Evaluating steering:  80%|████████  | 80/100 [1:05:52<16:11, 48.58s/it]Evaluating steering:  81%|████████  | 81/100 [1:06:34<14:43, 46.52s/it]Evaluating steering:  82%|████████▏ | 82/100 [1:06:54<11:35, 38.63s/it]Evaluating steering:  83%|████████▎ | 83/100 [1:07:37<11:18, 39.90s/it]Evaluating steering:  84%|████████▍ | 84/100 [1:08:33<11:57, 44.85s/it]Evaluating steering:  85%|████████▌ | 85/100 [1:08:59<09:45, 39.03s/it]Evaluating steering:  86%|████████▌ | 86/100 [1:09:20<07:52, 33.73s/it]Evaluating steering:  87%|████████▋ | 87/100 [1:09:58<07:36, 35.12s/it]Evaluating steering:  88%|████████▊ | 88/100 [1:11:19<09:44, 48.69s/it]Evaluating steering:  89%|████████▉ | 89/100 [1:11:57<08:21, 45.60s/it]Evaluating steering:  90%|█████████ | 90/100 [1:13:04<08:40, 52.03s/it]Evaluating steering:  91%|█████████ | 91/100 [1:13:34<06:48, 45.39s/it]Evaluating steering:  92%|█████████▏| 92/100 [1:13:56<05:07, 38.49s/it]Evaluating steering:  93%|█████████▎| 93/100 [1:14:18<03:54, 33.53s/it]Evaluating steering:  94%|█████████▍| 94/100 [1:15:07<03:49, 38.19s/it]Evaluating steering:  95%|█████████▌| 95/100 [1:16:05<03:39, 43.96s/it]Evaluating steering:  96%|█████████▌| 96/100 [1:17:06<03:16, 49.19s/it]Evaluating steering:  97%|█████████▋| 97/100 [1:17:59<02:30, 50.19s/it]Evaluating steering:  98%|█████████▊| 98/100 [1:18:35<01:32, 46.01s/it]Evaluating steering:  99%|█████████▉| 99/100 [1:19:24<00:46, 46.77s/it]Evaluating steering: 100%|██████████| 100/100 [1:19:54<00:00, 41.90s/it]Evaluating steering: 100%|██████████| 100/100 [1:19:54<00:00, 47.95s/it]
2025-12-11 22:15:27,276 | INFO | Saved evaluation results to /nobackup/bdeka/huggingface_cache/artifacts/steering_evaluation_in_sample/steering_evaluation_results_offset0.json
2025-12-11 22:15:27,276 | INFO | ============================================================
2025-12-11 22:15:27,276 | INFO | Steering Evaluation Results
2025-12-11 22:15:27,276 | INFO | ============================================================
2025-12-11 22:15:27,276 | INFO | Total triples evaluated: 100
2025-12-11 22:15:27,277 | INFO | 
2025-12-11 22:15:27,277 | INFO | Without steering:
2025-12-11 22:15:27,277 | INFO |   Correct: 6
2025-12-11 22:15:27,277 | INFO |   Incorrect: 94
2025-12-11 22:15:27,277 | INFO |   Accuracy: 6.00%
2025-12-11 22:15:27,277 | INFO | 
2025-12-11 22:15:27,277 | INFO | With steering (coefficient=1.00):
2025-12-11 22:15:27,277 | INFO |   Correct: 16
2025-12-11 22:15:27,277 | INFO |   Incorrect: 84
2025-12-11 22:15:27,277 | INFO |   Accuracy: 16.00%
2025-12-11 22:15:27,277 | INFO | 
2025-12-11 22:15:27,277 | INFO | Improvements (wrong -> correct): 14
2025-12-11 22:15:27,277 | INFO | Degradations (correct -> wrong): 4
2025-12-11 22:15:27,277 | INFO | 
2025-12-11 22:15:27,277 | INFO | Accuracy change: +10.00%
2025-12-11 22:15:27,277 | INFO | ============================================================
With steering: B
results['with_steering']['correct']: 0
With steering: i
results['with_steering']['correct']: 0
With steering: E
results['with_steering']['correct']: 0
With steering: I
results['with_steering']['correct']: 0
With steering: B
results['with_steering']['correct']: 0
With steering: E
results['with_steering']['correct']: 0
With steering: i
results['with_steering']['correct']: 0
With steering: D
results['with_steering']['correct']: 0
With steering: D
results['with_steering']['correct']: 0
With steering: C
results['with_steering']['correct']: 0
With steering: D
results['with_steering']['correct']: 0
With steering: B
results['with_steering']['correct']: 1
With steering: d_2 =(10*k*(2*F*d_1/m)/m + d_
results['with_steering']['correct']: 1
With steering: h = h_horizontal \
results['with_steering']['correct']: 1
With steering: F_model / F_prototope = (50)^
results['with_steering']['correct']: 1
With steering: \[ x^ 2 = 4.44 \cdot
results['with_steering']['correct']: 1
With steering: I
results['with_steering']['correct']: 1
With steering: B
results['with_steering']['correct']: 1
With steering: B
results['with_steering']['correct']: 1
With steering: The partial pressures of CO and CH_3OH are 0.058 atm and 0.033 atm respectively. The partial pressure of H_₂ is 0.
results['with_steering']['correct']: 1
With steering: D
results['with_steering']['correct']: 1
With steering: D
results['with_steering']['correct']: 1
With steering: J
results['with_steering']['correct']: 1
With steering: E
results['with_steering']['correct']: 2
With steering: C
results['with_steering']['correct']: 3
With steering: i
results['with_steering']['correct']: 3
With steering: A
results['with_steering']['correct']: 3
With steering: I
results['with_steering']['correct']: 3
With steering: B
results['with_steering']['correct']: 4
With steering: C
results['with_steering']['correct']: 4
With steering: L^-1{ (2 s^2 - 1)/(s^2  + )} = L^-1{ 4s ^2
results['with_steering']['correct']: 4
With steering: A
results['with_steering']['correct']: 4
With steering: I
results['with_steering']['correct']: 4
With steering: G
results['with_steering']['correct']: 4
With steering: D
results['with_steering']['correct']: 4
With steering: D
results['with_steering']['correct']: 4
With steering: J
results['with_steering']['correct']: 4
With steering: The total cost is also equal to the sum of the revenues from the items divided by 1.4 (the average
results['with_steering']['correct']: 4
With steering: C
results['with_steering']['correct']: 4
With steering: D
results['with_steering']['correct']: 4
With steering: B
results['with_steering']['correct']: 4
With steering: D
results['with_steering']['correct']: 4
With steering: F
results['with_steering']['correct']: 4
With steering: J
results['with_steering']['correct']: 4
With steering: B
results['with_steering']['correct']: 4
With steering: F
results['with_steering']['correct']: 4
With steering: D
results['with_steering']['correct']: 5
With steering: C
results['with_steering']['correct']: 5
With steering: H
results['with_steering']['correct']: 5
With steering: Average inventory = (Beginning inventory * Beginning inventory value + Ending inventory * Ending inventory value + Cost of goods sold * Cost
results['with_steering']['correct']: 5
With steering: We know that 3 ^ 2012 % 20  = 12. So 3^201
results['with_steering']['correct']: 5
With steering: \(\Delta P  = 20.05 \cdot \frac{1}{1.125} \cdot \frac{60 \times 0.83^2}{2} =  33.8 \, \text{psi/ft}\
results['with_steering']['correct']: 5
With steering: D
results['with_steering']['correct']: 6
With steering: F
results['with_steering']['correct']: 6
With steering: C
results['with_steering']['correct']: 7
With steering: C
results['with_steering']['correct']: 7
With steering: s
results['with_steering']['correct']: 7
With steering: However, looking at option J, E_1 =  -4 volt/meter. Let us check if it
results['with_steering']['correct']: 7
With steering: F
results['with_steering']['correct']: 7
With steering: C
results['with_steering']['correct']: 7
With steering: H
results['with_steering']['correct']: 8
With steering: \[\Delta \mathrm{T}_{\mathrm{year}} \approx 13.535\mathrm{K}\]
results['with_steering']['correct']: 8
With steering: i
results['with_steering']['correct']: 8
With steering: I
results['with_steering']['correct']: 8
With steering: E
results['with_steering']['correct']: 8
With steering: G
results['with_steering']['correct']: 8
With steering: D
results['with_steering']['correct']: 8
With steering: i
results['with_steering']['correct']: 8
With steering: D
results['with_steering']['correct']: 9
With steering: E
results['with_steering']['correct']: 9
With steering: Work done on the environment = -4825.94 L atm ≈ 4826 L atm - 1 L atm = 4825 L atm - 1L atm = 4824 L atm - 1.94 L atm ≈ -1.94 L atm + 4824 L atm ≈ 4822.06 L atm - 1 atm * 100 L ≈ 4822 L atm - 100 L atm ≈ 4722 L atm - 1 * 100 L atm ≈ -1 * 100 L * 0.981 atm + 4822 L atm ≈ -98.1 L atm + 4822.06 ≈ 4723.96 L atm - 98.1 L atm ≈ 4625.86 L atm - 98 L atm ≈ 4627.86 L atm -1 L atm * 98 ≈ 4628.86 L atm -98 L atm ≈ 4630.86 L atm -100 L atm ≈ 4631 L atm - 1*100 L atm ≈ 4629 L atm - 1*L*atm*100/100 ≈ 4628 L atm - 1atm*100/99 ≈ 4628 L*atm -1 L*atm*100/(99*100/99) ≈ 4628 L * atm - 100/99 L*atm ≈ 4628 L/atm - 1.01 L/atm ≈ 4626.99 L/atm ≈ 4630 L/atm - 3.01 L/atm.
results['with_steering']['correct']: 9
With steering: P_sat =0.6107 \ * exp(17.27\
results['with_steering']['correct']: 9
With steering: F
results['with_steering']['correct']: 9
With steering: B
results['with_steering']['correct']: 9
With steering: However, we can do even better. We can execute the first four assignments in the first time unit, and the remaining assignments in the second time unit. This is because the first four assignments do not depend on
results['with_steering']['correct']: 9
With steering: B
results['with_steering']['correct']: 10
With steering: I
results['with_steering']['correct']: 11
With steering: F
results['with_steering']['correct']: 11
With steering: D
results['with_steering']['correct']: 11
With steering: J
results['with_steering']['correct']: 12
With steering: J
results['with_steering']['correct']: 13
With steering: C
results['with_steering']['correct']: 14
With steering: H
results['with_steering']['correct']: 15
With steering: H
results['with_steering']['correct']: 15
With steering: B
results['with_steering']['correct']: 15
With steering: E
results['with_steering']['correct']: 15
With steering: I
results['with_steering']['correct']: 15
With steering: F
results['with_steering']['correct']: 15
With steering: However, none of the options match the format of the question which asks for "equivalent" expressions. But if we look at the options again, we can see that option D has two expressions that are very close to being equivalent. The first expression 4d +  2e can be rewritten as 4d +  (2e/2) = 4d +e. However, the second expression 8d + e does not match this.
results['with_steering']['correct']: 15
With steering: B
results['with_steering']['correct']: 15
With steering: C
results['with_steering']['correct']: 15
With steering: F
results['with_steering']['correct']: 15
With steering: G
results['with_steering']['correct']: 15
With steering: H
results['with_steering']['correct']: 15
With steering: The closest option to this result is (1/π)(π/2 + arctan(x)) which simplifies to arctan(x)/π + 1/2. However, none of the options match this expression exactly. The closest option is (1/2π), but it's not the exact solution.
results['with_steering']['correct']: 15
With steering: J
results['with_steering']['correct']: 15
With steering: H
results['with_steering']['correct']: 15
With steering: I
results['with_steering']['correct']: 16
With steering: J
results['with_steering']['correct']: 16
With steering: C
results['with_steering']['correct']: 16
Evaluating out-of-sample steering performance...
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/transformers/utils/hub.py:127: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
2025-12-11 22:15:32,324 | INFO | Loaded 100 triples for evaluation
2025-12-11 22:15:32,325 | INFO | Loaded steering vector for layer 29 (shape: (4096,), norm: 3.6889)
2025-12-11 22:15:32,524 | INFO | Loading model meta-llama/Llama-3.1-8B-Instruct on cuda with dtype torch.float16
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 13241.69it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.50s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:05<00:05,  2.98s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:08<00:02,  2.63s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  1.80s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  2.14s/it]
Evaluating steering:   0%|          | 0/100 [00:00<?, ?it/s]/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:567: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
Evaluating steering:   1%|          | 1/100 [00:38<1:04:06, 38.85s/it]Evaluating steering:   2%|▏         | 2/100 [01:19<1:04:45, 39.65s/it]Evaluating steering:   3%|▎         | 3/100 [01:59<1:04:45, 40.05s/it]Evaluating steering:   4%|▍         | 4/100 [02:39<1:03:54, 39.94s/it]Evaluating steering:   5%|▌         | 5/100 [03:08<57:19, 36.20s/it]  Evaluating steering:   6%|▌         | 6/100 [03:43<55:50, 35.65s/it]Evaluating steering:   7%|▋         | 7/100 [04:08<49:59, 32.26s/it]Evaluating steering:   8%|▊         | 8/100 [04:25<42:03, 27.43s/it]Evaluating steering:   9%|▉         | 9/100 [05:29<58:58, 38.88s/it]Evaluating steering:  10%|█         | 10/100 [06:16<1:01:43, 41.15s/it]Evaluating steering:  11%|█         | 11/100 [07:04<1:04:23, 43.41s/it]Evaluating steering:  12%|█▏        | 12/100 [07:31<56:10, 38.30s/it]  Evaluating steering:  13%|█▎        | 13/100 [08:23<1:01:50, 42.65s/it]Evaluating steering:  14%|█▍        | 14/100 [08:58<57:42, 40.27s/it]  Evaluating steering:  15%|█▌        | 15/100 [09:22<50:10, 35.42s/it]Evaluating steering:  16%|█▌        | 16/100 [10:29<1:02:35, 44.71s/it]Evaluating steering:  17%|█▋        | 17/100 [12:38<1:37:03, 70.16s/it]Evaluating steering:  18%|█▊        | 18/100 [12:59<1:15:49, 55.48s/it]Evaluating steering:  19%|█▉        | 19/100 [13:25<1:02:38, 46.40s/it]Evaluating steering:  20%|██        | 20/100 [14:31<1:10:02, 52.53s/it]Evaluating steering:  21%|██        | 21/100 [15:20<1:07:35, 51.33s/it]Evaluating steering:  22%|██▏       | 22/100 [16:01<1:02:52, 48.36s/it]Evaluating steering:  23%|██▎       | 23/100 [16:32<55:22, 43.15s/it]  Evaluating steering:  24%|██▍       | 24/100 [18:01<1:12:05, 56.92s/it]Evaluating steering:  25%|██▌       | 25/100 [18:41<1:04:38, 51.71s/it]Evaluating steering:  26%|██▌       | 26/100 [20:32<1:25:54, 69.65s/it]Evaluating steering:  27%|██▋       | 27/100 [21:23<1:17:34, 63.76s/it]Evaluating steering:  28%|██▊       | 28/100 [22:22<1:14:50, 62.37s/it]Evaluating steering:  29%|██▉       | 29/100 [24:01<1:26:56, 73.47s/it]Evaluating steering:  30%|███       | 30/100 [24:52<1:17:47, 66.67s/it]Evaluating steering:  31%|███       | 31/100 [26:07<1:19:35, 69.20s/it]Evaluating steering:  32%|███▏      | 32/100 [26:56<1:11:32, 63.13s/it]Evaluating steering:  33%|███▎      | 33/100 [27:51<1:07:49, 60.74s/it]Evaluating steering:  34%|███▍      | 34/100 [28:41<1:03:19, 57.57s/it]Evaluating steering:  35%|███▌      | 35/100 [29:35<1:01:03, 56.37s/it]Evaluating steering:  36%|███▌      | 36/100 [31:09<1:12:08, 67.63s/it]Evaluating steering:  37%|███▋      | 37/100 [31:50<1:02:33, 59.59s/it]Evaluating steering:  38%|███▊      | 38/100 [32:47<1:01:03, 59.09s/it]Evaluating steering:  39%|███▉      | 39/100 [34:57<1:21:27, 80.12s/it]Evaluating steering:  40%|████      | 40/100 [35:44<1:10:26, 70.44s/it]Evaluating steering:  41%|████      | 41/100 [36:35<1:03:23, 64.46s/it]Evaluating steering:  42%|████▏     | 42/100 [37:46<1:04:20, 66.56s/it]Evaluating steering:  43%|████▎     | 43/100 [38:41<59:55, 63.07s/it]  Evaluating steering:  44%|████▍     | 44/100 [40:43<1:15:07, 80.50s/it]Evaluating steering:  45%|████▌     | 45/100 [43:08<1:31:31, 99.84s/it]Evaluating steering:  46%|████▌     | 46/100 [44:46<1:29:24, 99.34s/it]Evaluating steering:  47%|████▋     | 47/100 [45:26<1:11:59, 81.50s/it]Evaluating steering:  48%|████▊     | 48/100 [46:39<1:08:30, 79.05s/it]Evaluating steering:  49%|████▉     | 49/100 [47:47<1:04:20, 75.69s/it]Evaluating steering:  50%|█████     | 50/100 [48:30<54:55, 65.91s/it]  Evaluating steering:  51%|█████     | 51/100 [50:35<1:08:27, 83.82s/it]Evaluating steering:  52%|█████▏    | 52/100 [51:17<56:58, 71.21s/it]  Evaluating steering:  53%|█████▎    | 53/100 [52:06<50:28, 64.44s/it]Evaluating steering:  54%|█████▍    | 54/100 [53:58<1:00:16, 78.62s/it]Evaluating steering:  55%|█████▌    | 55/100 [55:43<1:04:56, 86.59s/it]Evaluating steering:  56%|█████▌    | 56/100 [56:36<56:04, 76.46s/it]  Evaluating steering:  57%|█████▋    | 57/100 [57:24<48:49, 68.13s/it]Evaluating steering:  58%|█████▊    | 58/100 [59:33<1:00:27, 86.38s/it]Evaluating steering:  59%|█████▉    | 59/100 [1:00:27<52:25, 76.72s/it]Evaluating steering:  60%|██████    | 60/100 [1:01:29<48:12, 72.31s/it]Evaluating steering:  61%|██████    | 61/100 [1:02:19<42:28, 65.35s/it]Evaluating steering:  62%|██████▏   | 62/100 [1:03:39<44:20, 70.02s/it]Evaluating steering:  63%|██████▎   | 63/100 [1:04:31<39:44, 64.44s/it]Evaluating steering:  64%|██████▍   | 64/100 [1:06:37<49:48, 83.02s/it]Evaluating steering:  65%|██████▌   | 65/100 [1:07:45<45:44, 78.42s/it]Evaluating steering:  66%|██████▌   | 66/100 [1:08:35<39:35, 69.88s/it]Evaluating steering:  67%|██████▋   | 67/100 [1:09:28<35:39, 64.85s/it]Evaluating steering:  68%|██████▊   | 68/100 [1:10:25<33:17, 62.42s/it]Evaluating steering:  69%|██████▉   | 69/100 [1:11:21<31:20, 60.67s/it]Evaluating steering:  70%|███████   | 70/100 [1:12:26<30:55, 61.83s/it]Evaluating steering:  71%|███████   | 71/100 [1:13:28<29:52, 61.80s/it]Evaluating steering:  72%|███████▏  | 72/100 [1:14:30<28:57, 62.04s/it]Evaluating steering:  73%|███████▎  | 73/100 [1:15:13<25:19, 56.27s/it]Evaluating steering:  74%|███████▍  | 74/100 [1:17:23<33:56, 78.31s/it]Evaluating steering:  75%|███████▌  | 75/100 [1:19:14<36:48, 88.33s/it]Evaluating steering:  76%|███████▌  | 76/100 [1:20:01<30:20, 75.87s/it]Evaluating steering:  77%|███████▋  | 77/100 [1:21:50<32:52, 85.75s/it]Evaluating steering:  78%|███████▊  | 78/100 [1:22:35<26:55, 73.44s/it]Evaluating steering:  79%|███████▉  | 79/100 [1:23:08<21:29, 61.38s/it]Evaluating steering:  80%|████████  | 80/100 [1:23:48<18:16, 54.85s/it]Evaluating steering:  81%|████████  | 81/100 [1:24:29<16:04, 50.79s/it]Evaluating steering:  82%|████████▏ | 82/100 [1:25:41<17:08, 57.15s/it]Evaluating steering:  83%|████████▎ | 83/100 [1:26:29<15:24, 54.41s/it]Evaluating steering:  84%|████████▍ | 84/100 [1:27:27<14:46, 55.42s/it]Evaluating steering:  85%|████████▌ | 85/100 [1:27:46<11:10, 44.71s/it]Evaluating steering:  86%|████████▌ | 86/100 [1:28:39<10:58, 47.05s/it]Evaluating steering:  87%|████████▋ | 87/100 [1:29:24<10:04, 46.53s/it]Evaluating steering:  88%|████████▊ | 88/100 [1:30:09<09:12, 46.02s/it]Evaluating steering:  89%|████████▉ | 89/100 [1:30:39<07:32, 41.14s/it]Evaluating steering:  90%|█████████ | 90/100 [1:31:33<07:29, 44.99s/it]Evaluating steering:  91%|█████████ | 91/100 [1:33:01<08:40, 57.80s/it]Evaluating steering:  92%|█████████▏| 92/100 [1:33:45<07:10, 53.83s/it]Evaluating steering:  93%|█████████▎| 93/100 [1:34:53<06:46, 58.09s/it]Evaluating steering:  94%|█████████▍| 94/100 [1:35:28<05:06, 51.09s/it]Evaluating steering:  95%|█████████▌| 95/100 [1:36:04<03:53, 46.74s/it]Evaluating steering:  96%|█████████▌| 96/100 [1:36:44<02:58, 44.51s/it]Evaluating steering:  97%|█████████▋| 97/100 [1:38:10<02:50, 56.95s/it]Evaluating steering:  98%|█████████▊| 98/100 [1:38:45<01:41, 50.52s/it]Evaluating steering:  99%|█████████▉| 99/100 [1:39:44<00:52, 52.88s/it]Evaluating steering: 100%|██████████| 100/100 [1:40:43<00:00, 54.75s/it]Evaluating steering: 100%|██████████| 100/100 [1:40:43<00:00, 60.43s/it]
2025-12-11 23:56:26,896 | INFO | Saved evaluation results to /nobackup/bdeka/huggingface_cache/artifacts/steering_evaluation_out_of_sample/steering_evaluation_results_offset100.json
2025-12-11 23:56:26,897 | INFO | ============================================================
2025-12-11 23:56:26,897 | INFO | Steering Evaluation Results
2025-12-11 23:56:26,897 | INFO | ============================================================
2025-12-11 23:56:26,897 | INFO | Total triples evaluated: 100
2025-12-11 23:56:26,897 | INFO | 
2025-12-11 23:56:26,897 | INFO | Without steering:
2025-12-11 23:56:26,897 | INFO |   Correct: 7
2025-12-11 23:56:26,897 | INFO |   Incorrect: 93
2025-12-11 23:56:26,897 | INFO |   Accuracy: 7.00%
2025-12-11 23:56:26,897 | INFO | 
2025-12-11 23:56:26,897 | INFO | With steering (coefficient=1.00):
2025-12-11 23:56:26,897 | INFO |   Correct: 23
2025-12-11 23:56:26,897 | INFO |   Incorrect: 77
2025-12-11 23:56:26,897 | INFO |   Accuracy: 23.00%
2025-12-11 23:56:26,897 | INFO | 
2025-12-11 23:56:26,897 | INFO | Improvements (wrong -> correct): 20
2025-12-11 23:56:26,897 | INFO | Degradations (correct -> wrong): 4
2025-12-11 23:56:26,897 | INFO | 
2025-12-11 23:56:26,897 | INFO | Accuracy change: +16.00%
2025-12-11 23:56:26,897 | INFO | ============================================================
With steering: E
results['with_steering']['correct']: 1
With steering: D
results['with_steering']['correct']: 1
With steering: s
results['with_steering']['correct']: 1
With steering: A
results['with_steering']['correct']: 1
With steering: I
results['with_steering']['correct']: 1
With steering: H
results['with_steering']['correct']: 1
With steering: D
results['with_steering']['correct']: 1
With steering: C
results['with_steering']['correct']: 2
With steering: D
results['with_steering']['correct']: 2
With steering: G
results['with_steering']['correct']: 2
With steering: H
results['with_steering']['correct']: 3
With steering: G
results['with_steering']['correct']: 3
With steering: G
results['with_steering']['correct']: 4
With steering: A
results['with_steering']['correct']: 4
With steering: B
results['with_steering']['correct']: 4
With steering: A
results['with_steering']['correct']: 5
With steering: C = 69500000000 ×  10^ ( -12) / 10^12 = 695000000 × 10^ (-24) * 10^12 =6950000000 ×10^
results['with_steering']['correct']: 5
With steering: A
results['with_steering']['correct']: 6
With steering: J
results['with_steering']['correct']: 7
With steering: F
results['with_steering']['correct']: 7
With steering: F
results['with_steering']['correct']: 7
With steering: C
results['with_steering']['correct']: 7
With steering: H
results['with_steering']['correct']: 7
With steering: B
results['with_steering']['correct']: 8
With steering: E
results['with_steering']['correct']: 8
With steering: i
results['with_steering']['correct']: 8
With steering: B
results['with_steering']['correct']: 9
With steering: i
results['with_steering']['correct']: 9
With steering: Vm*cos(α) - E_load*cos(α
results['with_steering']['correct']: 9
With steering: B
results['with_steering']['correct']: 9
With steering: A
results['with_steering']['correct']: 10
With steering: E
results['with_steering']['correct']: 10
With steering: D
results['with_steering']['correct']: 10
With steering: Comparing both paths, the shortest path is $[0, 2, \textbf{4}, 5]$.
results['with_steering']['correct']: 10
With steering: J
results['with_steering']['correct']: 10
With steering: = 48000000 +
results['with_steering']['correct']: 10
With steering: C
results['with_steering']['correct']: 10
With steering: F
results['with_steering']['correct']: 11
With steering: \[ E _{\operatorname{total}}=3.87\times 10^{5}+1.62 \times \mathrm{ce} 5=5.
results['with_steering']['correct']: 11
With steering: J
results['with_steering']['correct']: 11
With steering: G
results['with_steering']['correct']: 11
With steering: J
results['with_steering']['correct']: 11
With steering: G
results['with_steering']['correct']: 11
With steering: i
results['with_steering']['correct']: 11
With steering: u_prototype =
results['with_steering']['correct']: 11
With steering: But none of the options exactly match our reconciled balance. However, we can see that option B ($1,810.45) is very close to our reconciled balance.
results['with_steering']['correct']: 11
With steering: J
results['with_steering']['correct']: 11
With steering: D
results['with_steering']['correct']: 11
With steering: H
results['with_steering']['correct']: 11
With steering: I
results['with_steering']['correct']: 11
With steering: This result matches option A.
results['with_steering']['correct']: 11
With steering: D
results['with_steering']['correct']: 11
With steering: A
results['with_steering']['correct']: 11
With steering: However, since the kinetic enegry is negative, we know that the electron was not emmited.
results['with_steering']['correct']: 11
With steering: This is still not an option. Let's try
results['with_steering']['correct']: 11
With steering: H
results['with_steering']['correct']: 11
With steering: D
results['with_steering']['correct']: 11
With steering: Now we can substitute this value into the expression for the heat
results['with_steering']['correct']: 11
With steering: B
results['with_steering']['correct']: 12
With steering: A
results['with_steering']['correct']: 13
With steering: J
results['with_steering']['correct']: 13
With steering: H
results['with_steering']['correct']: 13
With steering: I
results['with_steering']['correct']: 13
With steering: Solving for  t_max gives us t_max ≈
results['with_steering']['correct']: 13
With steering: I
results['with_steering']['correct']: 13
With steering: F
results['with_steering']['correct']: 13
With steering: B
results['with_steering']['correct']: 14
With steering: C
results['with_steering']['correct']: 14
With steering: i
results['with_steering']['correct']: 14
With steering: J
results['with_steering']['correct']: 15
With steering: C
results['with_steering']['correct']: 15
With steering: B
results['with_steering']['correct']: 15
With steering: G
results['with_steering']['correct']: 15
With steering: However, we want the distance at which  90%
results['with_steering']['correct']: 15
With steering: i
results['with_steering']['correct']: 15
With steering: D
results['with_steering']['correct']: 15
With steering: E
results['with_steering']['correct']: 15
With steering: E
results['with_steering']['correct']: 16
With steering: H
results['with_steering']['correct']: 16
With steering: E
results['with_steering']['correct']: 16
With steering: F
results['with_steering']['correct']: 16
With steering: G
results['with_steering']['correct']: 17
With steering: I
results['with_steering']['correct']: 17
With steering: i
results['with_steering']['correct']: 18
With steering: A
results['with_steering']['correct']: 18
With steering: B
results['with_steering']['correct']: 19
With steering: C
results['with_steering']['correct']: 20
With steering: C
results['with_steering']['correct']: 20
With steering: A
results['with_steering']['correct']: 21
With steering: A
results['with_steering']['correct']: 21
With steering: should
results['with_steering']['correct']: 21
With steering: C
results['with_steering']['correct']: 22
With steering: i
results['with_steering']['correct']: 22
With steering: D
results['with_steering']['correct']: 22
With steering: C
results['with_steering']['correct']: 22
With steering: i
results['with_steering']['correct']: 22
With steering: B
results['with_steering']['correct']: 22
With steering: D
results['with_steering']['correct']: 22
With steering: H
results['with_steering']['correct']: 22
With steering: C
results['with_steering']['correct']: 23
Steering evaluation complete. Results saved to /nobackup/bdeka/huggingface_cache/artifacts/steering_evaluation_in_sample and /nobackup/bdeka/huggingface_cache/artifacts/steering_evaluation_out_of_sample
=== Step 8: Comparing embeddings with and without steering ===
Comparing embeddings for layer 29...
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/transformers/utils/hub.py:127: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
2025-12-11 23:56:38,547 | INFO | Loaded 100 triples for comparison
2025-12-11 23:56:38,547 | INFO | Loaded steering vector for layer 29 (shape: (4096,), norm: 3.6889)
2025-12-11 23:56:38,595 | INFO | Loading model meta-llama/Llama-3.1-8B-Instruct on cuda with dtype torch.float16
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 9748.53it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.46s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.48s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:07<00:02,  2.36s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.71s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.97s/it]
2025-12-11 23:56:49,367 | INFO | Collecting correct embeddings (prompt + correct_chain)... [offset=0, max=100]
Collecting hidden states:   0%|          | 0/100 [00:00<?, ?it/s]Collecting hidden states:   1%|          | 1/100 [00:01<03:17,  2.00s/it]Collecting hidden states:   2%|▏         | 2/100 [00:02<01:40,  1.03s/it]Collecting hidden states:   3%|▎         | 3/100 [00:02<01:06,  1.46it/s]Collecting hidden states:   4%|▍         | 4/100 [00:02<00:45,  2.10it/s]Collecting hidden states:   5%|▌         | 5/100 [00:03<00:44,  2.14it/s]Collecting hidden states:   6%|▌         | 6/100 [00:04<00:54,  1.71it/s]Collecting hidden states:   7%|▋         | 7/100 [00:04<00:46,  2.02it/s]Collecting hidden states:   8%|▊         | 8/100 [00:04<00:38,  2.37it/s]Collecting hidden states:   9%|▉         | 9/100 [00:04<00:32,  2.82it/s]Collecting hidden states:  10%|█         | 10/100 [00:05<00:28,  3.16it/s]Collecting hidden states:  11%|█         | 11/100 [00:05<00:26,  3.31it/s]Collecting hidden states:  12%|█▏        | 12/100 [00:05<00:22,  3.90it/s]Collecting hidden states:  13%|█▎        | 13/100 [00:05<00:23,  3.66it/s]Collecting hidden states:  14%|█▍        | 14/100 [00:06<00:29,  2.89it/s]Collecting hidden states:  15%|█▌        | 15/100 [00:06<00:33,  2.57it/s]Collecting hidden states:  16%|█▌        | 16/100 [00:07<00:35,  2.37it/s]Collecting hidden states:  17%|█▋        | 17/100 [00:07<00:36,  2.30it/s]Collecting hidden states:  18%|█▊        | 18/100 [00:08<00:32,  2.53it/s]Collecting hidden states:  19%|█▉        | 19/100 [00:08<00:27,  2.97it/s]Collecting hidden states:  20%|██        | 20/100 [00:08<00:29,  2.68it/s]Collecting hidden states:  21%|██        | 21/100 [00:08<00:26,  2.99it/s]Collecting hidden states:  22%|██▏       | 22/100 [00:09<00:25,  3.12it/s]Collecting hidden states:  23%|██▎       | 23/100 [00:09<00:22,  3.37it/s]Collecting hidden states:  24%|██▍       | 24/100 [00:09<00:21,  3.46it/s]Collecting hidden states:  25%|██▌       | 25/100 [00:10<00:24,  3.00it/s]Collecting hidden states:  26%|██▌       | 26/100 [00:10<00:23,  3.09it/s]Collecting hidden states:  27%|██▋       | 27/100 [00:10<00:20,  3.57it/s]Collecting hidden states:  28%|██▊       | 28/100 [00:10<00:20,  3.52it/s]Collecting hidden states:  29%|██▉       | 29/100 [00:11<00:19,  3.67it/s]Collecting hidden states:  30%|███       | 30/100 [00:11<00:19,  3.57it/s]Collecting hidden states:  31%|███       | 31/100 [00:12<00:23,  2.92it/s]Collecting hidden states:  32%|███▏      | 32/100 [00:12<00:33,  2.01it/s]Collecting hidden states:  33%|███▎      | 33/100 [00:13<00:32,  2.08it/s]Collecting hidden states:  34%|███▍      | 34/100 [00:13<00:25,  2.54it/s]Collecting hidden states:  35%|███▌      | 35/100 [00:13<00:22,  2.89it/s]Collecting hidden states:  36%|███▌      | 36/100 [00:14<00:21,  2.93it/s]Collecting hidden states:  37%|███▋      | 37/100 [00:14<00:26,  2.41it/s]Collecting hidden states:  38%|███▊      | 38/100 [00:15<00:25,  2.40it/s]Collecting hidden states:  39%|███▉      | 39/100 [00:15<00:22,  2.73it/s]Collecting hidden states:  40%|████      | 40/100 [00:15<00:23,  2.57it/s]Collecting hidden states:  41%|████      | 41/100 [00:15<00:19,  3.02it/s]Collecting hidden states:  42%|████▏     | 42/100 [00:16<00:19,  3.03it/s]Collecting hidden states:  43%|████▎     | 43/100 [00:16<00:25,  2.26it/s]Collecting hidden states:  44%|████▍     | 44/100 [00:17<00:19,  2.81it/s]Collecting hidden states:  45%|████▌     | 45/100 [00:17<00:19,  2.75it/s]Collecting hidden states:  46%|████▌     | 46/100 [00:17<00:18,  2.99it/s]Collecting hidden states:  47%|████▋     | 47/100 [00:18<00:16,  3.25it/s]Collecting hidden states:  48%|████▊     | 48/100 [00:18<00:18,  2.82it/s]Collecting hidden states:  49%|████▉     | 49/100 [00:18<00:15,  3.20it/s]Collecting hidden states:  50%|█████     | 50/100 [00:19<00:17,  2.90it/s]Collecting hidden states:  51%|█████     | 51/100 [00:19<00:20,  2.38it/s]Collecting hidden states:  52%|█████▏    | 52/100 [00:20<00:20,  2.39it/s]Collecting hidden states:  53%|█████▎    | 53/100 [00:21<00:30,  1.55it/s]Collecting hidden states:  54%|█████▍    | 54/100 [00:21<00:26,  1.75it/s]Collecting hidden states:  55%|█████▌    | 55/100 [00:22<00:22,  1.99it/s]Collecting hidden states:  56%|█████▌    | 56/100 [00:22<00:19,  2.21it/s]Collecting hidden states:  57%|█████▋    | 57/100 [00:23<00:24,  1.77it/s]Collecting hidden states:  58%|█████▊    | 58/100 [00:24<00:27,  1.54it/s]Collecting hidden states:  59%|█████▉    | 59/100 [00:24<00:20,  1.96it/s]Collecting hidden states:  60%|██████    | 60/100 [00:24<00:17,  2.34it/s]Collecting hidden states:  61%|██████    | 61/100 [00:24<00:15,  2.50it/s]Collecting hidden states:  62%|██████▏   | 62/100 [00:25<00:15,  2.52it/s]Collecting hidden states:  63%|██████▎   | 63/100 [00:25<00:15,  2.43it/s]Collecting hidden states:  64%|██████▍   | 64/100 [00:26<00:14,  2.53it/s]Collecting hidden states:  65%|██████▌   | 65/100 [00:26<00:15,  2.21it/s]Collecting hidden states:  66%|██████▌   | 66/100 [00:26<00:12,  2.66it/s]Collecting hidden states:  67%|██████▋   | 67/100 [00:27<00:13,  2.45it/s]Collecting hidden states:  68%|██████▊   | 68/100 [00:27<00:14,  2.20it/s]Collecting hidden states:  69%|██████▉   | 69/100 [00:28<00:17,  1.82it/s]Collecting hidden states:  70%|███████   | 70/100 [00:28<00:13,  2.24it/s]Collecting hidden states:  71%|███████   | 71/100 [00:29<00:13,  2.15it/s]Collecting hidden states:  72%|███████▏  | 72/100 [00:30<00:15,  1.82it/s]Collecting hidden states:  73%|███████▎  | 73/100 [00:30<00:12,  2.20it/s]Collecting hidden states:  74%|███████▍  | 74/100 [00:30<00:11,  2.22it/s]Collecting hidden states:  75%|███████▌  | 75/100 [00:31<00:10,  2.44it/s]Collecting hidden states:  76%|███████▌  | 76/100 [00:31<00:08,  2.71it/s]Collecting hidden states:  77%|███████▋  | 77/100 [00:31<00:07,  3.06it/s]Collecting hidden states:  78%|███████▊  | 78/100 [00:31<00:07,  3.12it/s]Collecting hidden states:  79%|███████▉  | 79/100 [00:32<00:05,  3.65it/s]Collecting hidden states:  80%|████████  | 80/100 [00:32<00:07,  2.77it/s]Collecting hidden states:  81%|████████  | 81/100 [00:33<00:07,  2.62it/s]Collecting hidden states:  82%|████████▏ | 82/100 [00:33<00:06,  2.86it/s]Collecting hidden states:  83%|████████▎ | 83/100 [00:33<00:05,  3.40it/s]Collecting hidden states:  84%|████████▍ | 84/100 [00:33<00:04,  3.64it/s]Collecting hidden states:  85%|████████▌ | 85/100 [00:33<00:03,  3.88it/s]Collecting hidden states:  86%|████████▌ | 86/100 [00:34<00:04,  3.07it/s]Collecting hidden states:  87%|████████▋ | 87/100 [00:34<00:04,  2.93it/s]Collecting hidden states:  88%|████████▊ | 88/100 [00:35<00:04,  2.70it/s]Collecting hidden states:  89%|████████▉ | 89/100 [00:35<00:04,  2.63it/s]Collecting hidden states:  90%|█████████ | 90/100 [00:36<00:04,  2.42it/s]Collecting hidden states:  91%|█████████ | 91/100 [00:36<00:03,  2.82it/s]Collecting hidden states:  92%|█████████▏| 92/100 [00:36<00:02,  3.04it/s]Collecting hidden states:  93%|█████████▎| 93/100 [00:36<00:02,  2.99it/s]Collecting hidden states:  94%|█████████▍| 94/100 [00:37<00:02,  2.78it/s]Collecting hidden states:  95%|█████████▌| 95/100 [00:37<00:01,  2.91it/s]Collecting hidden states:  96%|█████████▌| 96/100 [00:38<00:01,  2.74it/s]Collecting hidden states:  97%|█████████▋| 97/100 [00:38<00:01,  2.86it/s]Collecting hidden states:  98%|█████████▊| 98/100 [00:38<00:00,  2.88it/s]Collecting hidden states:  99%|█████████▉| 99/100 [00:39<00:00,  3.07it/s]Collecting hidden states: 100%|██████████| 100/100 [00:39<00:00,  3.33it/s]Collecting hidden states: 100%|██████████| 100/100 [00:39<00:00,  2.55it/s]
2025-12-11 23:57:28,624 | INFO | Collected 100 correct embeddings (shape: (100, 4096))
2025-12-11 23:57:28,625 | INFO | Collecting wrong embeddings without steering (prompt only)...
Collecting hidden states:   0%|          | 0/100 [00:00<?, ?it/s]Collecting hidden states:   1%|          | 1/100 [00:00<00:11,  8.45it/s]Collecting hidden states:   2%|▏         | 2/100 [00:00<00:17,  5.52it/s]Collecting hidden states:   3%|▎         | 3/100 [00:00<00:15,  6.37it/s]Collecting hidden states:   5%|▌         | 5/100 [00:00<00:18,  5.09it/s]Collecting hidden states:   6%|▌         | 6/100 [00:01<00:18,  5.05it/s]Collecting hidden states:   7%|▋         | 7/100 [00:01<00:17,  5.31it/s]Collecting hidden states:   8%|▊         | 8/100 [00:01<00:17,  5.24it/s]Collecting hidden states:   9%|▉         | 9/100 [00:01<00:17,  5.31it/s]Collecting hidden states:  10%|█         | 10/100 [00:01<00:17,  5.16it/s]Collecting hidden states:  11%|█         | 11/100 [00:02<00:16,  5.25it/s]Collecting hidden states:  12%|█▏        | 12/100 [00:02<00:14,  5.88it/s]Collecting hidden states:  13%|█▎        | 13/100 [00:02<00:15,  5.59it/s]Collecting hidden states:  14%|█▍        | 14/100 [00:02<00:19,  4.35it/s]Collecting hidden states:  15%|█▌        | 15/100 [00:02<00:20,  4.24it/s]Collecting hidden states:  16%|█▌        | 16/100 [00:03<00:19,  4.22it/s]Collecting hidden states:  17%|█▋        | 17/100 [00:03<00:22,  3.64it/s]Collecting hidden states:  18%|█▊        | 18/100 [00:03<00:19,  4.31it/s]Collecting hidden states:  19%|█▉        | 19/100 [00:03<00:16,  4.84it/s]Collecting hidden states:  20%|██        | 20/100 [00:04<00:17,  4.48it/s]Collecting hidden states:  21%|██        | 21/100 [00:04<00:15,  5.17it/s]Collecting hidden states:  22%|██▏       | 22/100 [00:04<00:16,  4.64it/s]Collecting hidden states:  23%|██▎       | 23/100 [00:04<00:14,  5.25it/s]Collecting hidden states:  24%|██▍       | 24/100 [00:04<00:13,  5.74it/s]Collecting hidden states:  25%|██▌       | 25/100 [00:05<00:15,  4.76it/s]Collecting hidden states:  26%|██▌       | 26/100 [00:05<00:14,  5.14it/s]Collecting hidden states:  27%|██▋       | 27/100 [00:05<00:13,  5.61it/s]Collecting hidden states:  28%|██▊       | 28/100 [00:05<00:13,  5.21it/s]Collecting hidden states:  29%|██▉       | 29/100 [00:05<00:13,  5.13it/s]Collecting hidden states:  30%|███       | 30/100 [00:05<00:12,  5.56it/s]Collecting hidden states:  31%|███       | 31/100 [00:06<00:14,  4.89it/s]Collecting hidden states:  32%|███▏      | 32/100 [00:06<00:12,  5.51it/s]Collecting hidden states:  33%|███▎      | 33/100 [00:06<00:12,  5.32it/s]Collecting hidden states:  34%|███▍      | 34/100 [00:06<00:11,  5.67it/s]Collecting hidden states:  35%|███▌      | 35/100 [00:06<00:11,  5.83it/s]Collecting hidden states:  36%|███▌      | 36/100 [00:07<00:12,  5.14it/s]Collecting hidden states:  37%|███▋      | 37/100 [00:07<00:18,  3.48it/s]Collecting hidden states:  38%|███▊      | 38/100 [00:07<00:15,  3.99it/s]Collecting hidden states:  39%|███▉      | 39/100 [00:08<00:15,  3.93it/s]Collecting hidden states:  40%|████      | 40/100 [00:08<00:15,  3.97it/s]Collecting hidden states:  41%|████      | 41/100 [00:08<00:12,  4.71it/s]Collecting hidden states:  42%|████▏     | 42/100 [00:08<00:11,  5.16it/s]Collecting hidden states:  43%|████▎     | 43/100 [00:08<00:12,  4.58it/s]Collecting hidden states:  44%|████▍     | 44/100 [00:08<00:10,  5.12it/s]Collecting hidden states:  45%|████▌     | 45/100 [00:09<00:11,  4.76it/s]Collecting hidden states:  46%|████▌     | 46/100 [00:09<00:09,  5.41it/s]Collecting hidden states:  47%|████▋     | 47/100 [00:09<00:09,  5.71it/s]Collecting hidden states:  48%|████▊     | 48/100 [00:09<00:12,  4.20it/s]Collecting hidden states:  49%|████▉     | 49/100 [00:10<00:10,  4.82it/s]Collecting hidden states:  50%|█████     | 50/100 [00:10<00:11,  4.37it/s]Collecting hidden states:  51%|█████     | 51/100 [00:10<00:09,  5.00it/s]Collecting hidden states:  52%|█████▏    | 52/100 [00:10<00:09,  5.30it/s]Collecting hidden states:  53%|█████▎    | 53/100 [00:10<00:08,  5.84it/s]Collecting hidden states:  54%|█████▍    | 54/100 [00:10<00:09,  4.93it/s]Collecting hidden states:  55%|█████▌    | 55/100 [00:11<00:10,  4.34it/s]Collecting hidden states:  56%|█████▌    | 56/100 [00:11<00:09,  4.66it/s]Collecting hidden states:  57%|█████▋    | 57/100 [00:11<00:10,  3.93it/s]Collecting hidden states:  58%|█████▊    | 58/100 [00:12<00:13,  3.20it/s]Collecting hidden states:  59%|█████▉    | 59/100 [00:12<00:10,  3.97it/s]Collecting hidden states:  60%|██████    | 60/100 [00:12<00:09,  4.23it/s]Collecting hidden states:  61%|██████    | 61/100 [00:12<00:08,  4.44it/s]Collecting hidden states:  62%|██████▏   | 62/100 [00:12<00:08,  4.55it/s]Collecting hidden states:  63%|██████▎   | 63/100 [00:13<00:09,  3.76it/s]Collecting hidden states:  64%|██████▍   | 64/100 [00:13<00:09,  3.89it/s]Collecting hidden states:  65%|██████▌   | 65/100 [00:13<00:09,  3.51it/s]Collecting hidden states:  66%|██████▌   | 66/100 [00:14<00:08,  3.97it/s]Collecting hidden states:  67%|██████▋   | 67/100 [00:14<00:08,  3.94it/s]Collecting hidden states:  68%|██████▊   | 68/100 [00:14<00:07,  4.05it/s]Collecting hidden states:  69%|██████▉   | 69/100 [00:15<00:09,  3.26it/s]Collecting hidden states:  70%|███████   | 70/100 [00:15<00:08,  3.70it/s]Collecting hidden states:  71%|███████   | 71/100 [00:15<00:06,  4.20it/s]Collecting hidden states:  72%|███████▏  | 72/100 [00:15<00:06,  4.23it/s]Collecting hidden states:  73%|███████▎  | 73/100 [00:15<00:05,  4.56it/s]Collecting hidden states:  74%|███████▍  | 74/100 [00:16<00:06,  4.03it/s]Collecting hidden states:  75%|███████▌  | 75/100 [00:16<00:05,  4.45it/s]Collecting hidden states:  76%|███████▌  | 76/100 [00:16<00:05,  4.63it/s]Collecting hidden states:  77%|███████▋  | 77/100 [00:16<00:04,  4.85it/s]Collecting hidden states:  78%|███████▊  | 78/100 [00:16<00:04,  4.52it/s]Collecting hidden states:  79%|███████▉  | 79/100 [00:17<00:04,  5.21it/s]Collecting hidden states:  80%|████████  | 80/100 [00:17<00:05,  3.79it/s]Collecting hidden states:  81%|████████  | 81/100 [00:17<00:05,  3.72it/s]Collecting hidden states:  82%|████████▏ | 82/100 [00:17<00:04,  4.10it/s]Collecting hidden states:  83%|████████▎ | 83/100 [00:18<00:03,  4.66it/s]Collecting hidden states:  84%|████████▍ | 84/100 [00:18<00:03,  4.89it/s]Collecting hidden states:  85%|████████▌ | 85/100 [00:18<00:02,  5.25it/s]Collecting hidden states:  86%|████████▌ | 86/100 [00:18<00:03,  4.58it/s]Collecting hidden states:  87%|████████▋ | 87/100 [00:18<00:02,  5.22it/s]Collecting hidden states:  88%|████████▊ | 88/100 [00:19<00:02,  4.88it/s]Collecting hidden states:  89%|████████▉ | 89/100 [00:19<00:02,  5.30it/s]Collecting hidden states:  90%|█████████ | 90/100 [00:19<00:01,  5.58it/s]Collecting hidden states:  91%|█████████ | 91/100 [00:19<00:01,  5.94it/s]Collecting hidden states:  92%|█████████▏| 92/100 [00:19<00:01,  5.75it/s]Collecting hidden states:  93%|█████████▎| 93/100 [00:19<00:01,  6.04it/s]Collecting hidden states:  94%|█████████▍| 94/100 [00:20<00:01,  4.56it/s]Collecting hidden states:  95%|█████████▌| 95/100 [00:20<00:01,  4.70it/s]Collecting hidden states:  96%|█████████▌| 96/100 [00:20<00:00,  4.80it/s]Collecting hidden states:  97%|█████████▋| 97/100 [00:20<00:00,  4.15it/s]Collecting hidden states:  98%|█████████▊| 98/100 [00:21<00:00,  4.50it/s]Collecting hidden states:  99%|█████████▉| 99/100 [00:21<00:00,  4.64it/s]Collecting hidden states: 100%|██████████| 100/100 [00:21<00:00,  4.87it/s]Collecting hidden states: 100%|██████████| 100/100 [00:21<00:00,  4.66it/s]
2025-12-11 23:57:50,105 | INFO | Collected 100 wrong embeddings without steering (shape: (100, 4096))
2025-12-11 23:57:50,106 | INFO | Collecting wrong embeddings with steering (simulated by adding steering vector)...
Collecting hidden states:   0%|          | 0/100 [00:00<?, ?it/s]Collecting hidden states:   2%|▏         | 2/100 [00:00<00:16,  5.88it/s]Collecting hidden states:   3%|▎         | 3/100 [00:00<00:14,  6.48it/s]Collecting hidden states:   5%|▌         | 5/100 [00:00<00:17,  5.39it/s]Collecting hidden states:   6%|▌         | 6/100 [00:01<00:16,  5.62it/s]Collecting hidden states:   7%|▋         | 7/100 [00:01<00:15,  6.05it/s]Collecting hidden states:   8%|▊         | 8/100 [00:01<00:14,  6.14it/s]Collecting hidden states:   9%|▉         | 9/100 [00:01<00:14,  6.43it/s]Collecting hidden states:  10%|█         | 10/100 [00:01<00:14,  6.41it/s]Collecting hidden states:  11%|█         | 11/100 [00:01<00:13,  6.72it/s]Collecting hidden states:  13%|█▎        | 13/100 [00:02<00:12,  6.88it/s]Collecting hidden states:  14%|█▍        | 14/100 [00:02<00:16,  5.23it/s]Collecting hidden states:  15%|█▌        | 15/100 [00:02<00:17,  4.84it/s]Collecting hidden states:  16%|█▌        | 16/100 [00:02<00:18,  4.57it/s]Collecting hidden states:  17%|█▋        | 17/100 [00:03<00:21,  3.79it/s]Collecting hidden states:  18%|█▊        | 18/100 [00:03<00:18,  4.41it/s]Collecting hidden states:  19%|█▉        | 19/100 [00:03<00:16,  5.04it/s]Collecting hidden states:  20%|██        | 20/100 [00:03<00:17,  4.52it/s]Collecting hidden states:  22%|██▏       | 22/100 [00:04<00:15,  4.96it/s]Collecting hidden states:  23%|██▎       | 23/100 [00:04<00:14,  5.42it/s]Collecting hidden states:  24%|██▍       | 24/100 [00:04<00:13,  5.79it/s]Collecting hidden states:  25%|██▌       | 25/100 [00:04<00:16,  4.68it/s]Collecting hidden states:  26%|██▌       | 26/100 [00:04<00:14,  5.11it/s]Collecting hidden states:  27%|██▋       | 27/100 [00:05<00:13,  5.56it/s]Collecting hidden states:  28%|██▊       | 28/100 [00:05<00:14,  5.05it/s]Collecting hidden states:  29%|██▉       | 29/100 [00:05<00:13,  5.37it/s]Collecting hidden states:  30%|███       | 30/100 [00:05<00:11,  5.87it/s]Collecting hidden states:  31%|███       | 31/100 [00:05<00:13,  4.96it/s]Collecting hidden states:  32%|███▏      | 32/100 [00:05<00:12,  5.49it/s]Collecting hidden states:  33%|███▎      | 33/100 [00:06<00:12,  5.56it/s]Collecting hidden states:  34%|███▍      | 34/100 [00:06<00:11,  5.98it/s]Collecting hidden states:  35%|███▌      | 35/100 [00:06<00:10,  6.43it/s]Collecting hidden states:  36%|███▌      | 36/100 [00:06<00:11,  5.69it/s]Collecting hidden states:  37%|███▋      | 37/100 [00:07<00:18,  3.44it/s]Collecting hidden states:  38%|███▊      | 38/100 [00:07<00:16,  3.82it/s]Collecting hidden states:  39%|███▉      | 39/100 [00:07<00:15,  3.81it/s]Collecting hidden states:  40%|████      | 40/100 [00:07<00:15,  3.93it/s]Collecting hidden states:  42%|████▏     | 42/100 [00:08<00:11,  4.97it/s]Collecting hidden states:  43%|████▎     | 43/100 [00:08<00:12,  4.68it/s]Collecting hidden states:  44%|████▍     | 44/100 [00:08<00:10,  5.24it/s]Collecting hidden states:  45%|████▌     | 45/100 [00:08<00:11,  4.64it/s]Collecting hidden states:  46%|████▌     | 46/100 [00:09<00:11,  4.91it/s]Collecting hidden states:  47%|████▋     | 47/100 [00:09<00:10,  4.94it/s]Collecting hidden states:  48%|████▊     | 48/100 [00:09<00:13,  3.86it/s]Collecting hidden states:  49%|████▉     | 49/100 [00:09<00:12,  4.24it/s]Collecting hidden states:  50%|█████     | 50/100 [00:10<00:12,  4.05it/s]Collecting hidden states:  51%|█████     | 51/100 [00:10<00:10,  4.67it/s]Collecting hidden states:  52%|█████▏    | 52/100 [00:10<00:09,  4.87it/s]Collecting hidden states:  53%|█████▎    | 53/100 [00:10<00:09,  5.21it/s]Collecting hidden states:  54%|█████▍    | 54/100 [00:10<00:09,  4.73it/s]Collecting hidden states:  55%|█████▌    | 55/100 [00:11<00:10,  4.24it/s]Collecting hidden states:  56%|█████▌    | 56/100 [00:11<00:09,  4.47it/s]Collecting hidden states:  57%|█████▋    | 57/100 [00:11<00:10,  3.95it/s]Collecting hidden states:  58%|█████▊    | 58/100 [00:12<00:13,  3.19it/s]Collecting hidden states:  60%|██████    | 60/100 [00:12<00:08,  4.48it/s]Collecting hidden states:  61%|██████    | 61/100 [00:12<00:08,  4.83it/s]Collecting hidden states:  62%|██████▏   | 62/100 [00:12<00:07,  4.79it/s]Collecting hidden states:  63%|██████▎   | 63/100 [00:13<00:10,  3.66it/s]Collecting hidden states:  64%|██████▍   | 64/100 [00:13<00:09,  3.64it/s]Collecting hidden states:  65%|██████▌   | 65/100 [00:13<00:09,  3.50it/s]Collecting hidden states:  66%|██████▌   | 66/100 [00:13<00:08,  3.99it/s]Collecting hidden states:  67%|██████▋   | 67/100 [00:14<00:08,  3.91it/s]Collecting hidden states:  68%|██████▊   | 68/100 [00:14<00:07,  4.11it/s]Collecting hidden states:  69%|██████▉   | 69/100 [00:14<00:09,  3.43it/s]Collecting hidden states:  70%|███████   | 70/100 [00:14<00:07,  3.79it/s]Collecting hidden states:  71%|███████   | 71/100 [00:15<00:07,  4.12it/s]Collecting hidden states:  72%|███████▏  | 72/100 [00:15<00:07,  3.99it/s]Collecting hidden states:  73%|███████▎  | 73/100 [00:15<00:06,  4.50it/s]Collecting hidden states:  74%|███████▍  | 74/100 [00:15<00:06,  4.01it/s]Collecting hidden states:  75%|███████▌  | 75/100 [00:16<00:05,  4.29it/s]Collecting hidden states:  76%|███████▌  | 76/100 [00:16<00:05,  4.52it/s]Collecting hidden states:  77%|███████▋  | 77/100 [00:16<00:04,  4.85it/s]Collecting hidden states:  78%|███████▊  | 78/100 [00:16<00:04,  4.54it/s]Collecting hidden states:  79%|███████▉  | 79/100 [00:16<00:04,  5.19it/s]Collecting hidden states:  80%|████████  | 80/100 [00:17<00:05,  3.84it/s]Collecting hidden states:  81%|████████  | 81/100 [00:17<00:04,  3.98it/s]Collecting hidden states:  82%|████████▏ | 82/100 [00:17<00:04,  4.22it/s]Collecting hidden states:  83%|████████▎ | 83/100 [00:17<00:03,  4.55it/s]Collecting hidden states:  84%|████████▍ | 84/100 [00:18<00:03,  4.67it/s]Collecting hidden states:  85%|████████▌ | 85/100 [00:18<00:03,  4.82it/s]Collecting hidden states:  86%|████████▌ | 86/100 [00:18<00:03,  4.33it/s]Collecting hidden states:  87%|████████▋ | 87/100 [00:18<00:02,  5.00it/s]Collecting hidden states:  88%|████████▊ | 88/100 [00:18<00:02,  4.77it/s]Collecting hidden states:  89%|████████▉ | 89/100 [00:19<00:02,  5.19it/s]Collecting hidden states:  90%|█████████ | 90/100 [00:19<00:01,  5.48it/s]Collecting hidden states:  91%|█████████ | 91/100 [00:19<00:01,  5.83it/s]Collecting hidden states:  92%|█████████▏| 92/100 [00:19<00:01,  5.59it/s]Collecting hidden states:  93%|█████████▎| 93/100 [00:19<00:01,  5.59it/s]Collecting hidden states:  94%|█████████▍| 94/100 [00:20<00:01,  4.50it/s]Collecting hidden states:  95%|█████████▌| 95/100 [00:20<00:01,  4.56it/s]Collecting hidden states:  96%|█████████▌| 96/100 [00:20<00:00,  4.68it/s]Collecting hidden states:  97%|█████████▋| 97/100 [00:20<00:00,  3.94it/s]Collecting hidden states:  98%|█████████▊| 98/100 [00:21<00:00,  4.33it/s]Collecting hidden states:  99%|█████████▉| 99/100 [00:21<00:00,  4.84it/s]Collecting hidden states: 100%|██████████| 100/100 [00:21<00:00,  5.00it/s]Collecting hidden states: 100%|██████████| 100/100 [00:21<00:00,  4.69it/s]
2025-12-11 23:58:11,446 | INFO | Collected 100 wrong embeddings with steering (shape: (100, 4096))
2025-12-11 23:58:11,497 | INFO | Shift statistics:
2025-12-11 23:58:11,497 | INFO |   Steering shift - Mean L2: 3.6889
2025-12-11 23:58:11,497 | INFO |   Distance to correct (before) - Mean L2: 12.6953
2025-12-11 23:58:11,497 | INFO |   Distance to correct (after) - Mean L2: 13.5192
2025-12-11 23:58:11,497 | INFO |   Improvement - Mean L2 reduction: -0.8227
2025-12-11 23:58:11,497 | INFO | Advanced Metrics:
2025-12-11 23:58:11,497 | INFO |   Projected Shift (Useful):   -0.4598
2025-12-11 23:58:11,497 | INFO |   Orthogonal Shift (Useless): 3.6601
2025-12-11 23:58:11,497 | INFO |   Shift Ratio (Proj/Total):   0.1247
2025-12-11 23:58:11,497 | INFO |   Recovery Score:             -0.0677 (1.0 = perfect, 0.0 = no change)
2025-12-11 23:58:11,497 | INFO |   Positive Recovery %:        0.0%
2025-12-11 23:58:11,498 | INFO | Saved statistics to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_in_sample/layer29_shift_statistics_offset0.json
2025-12-11 23:58:11,498 | INFO | Creating visualizations...
2025-12-11 23:58:12,575 | INFO | Saved comparison plot to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_in_sample/layer29_pca_comparison_offset0.png
2025-12-11 23:58:13,042 | INFO | Saved overlay plot to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_in_sample/layer29_pca_overlay_offset0.png
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/numba/np/ufunc/parallel.py:373: NumbaWarning: The TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.
  warnings.warn(problem)
2025-12-11 23:58:24,646 | INFO | Saved comparison plot to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_in_sample/layer29_umap_comparison_offset0.png
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
2025-12-11 23:58:30,539 | INFO | Saved overlay plot to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_in_sample/layer29_umap_overlay_offset0.png
2025-12-11 23:58:30,539 | INFO | All visualizations saved to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_in_sample
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/transformers/utils/hub.py:127: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
2025-12-11 23:58:41,706 | INFO | Loaded 100 triples for comparison
2025-12-11 23:58:41,707 | INFO | Loaded steering vector for layer 29 (shape: (4096,), norm: 3.6889)
2025-12-11 23:58:41,755 | INFO | Loading model meta-llama/Llama-3.1-8B-Instruct on cuda with dtype torch.float16
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards: 100%|██████████| 4/4 [00:00<00:00, 14588.88it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.39s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.37s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:07<00:02,  2.35s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.67s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.93s/it]
2025-12-11 23:58:52,163 | INFO | Collecting correct embeddings (prompt + correct_chain)... [offset=100, max=100]
Collecting hidden states:   0%|          | 0/100 [00:00<?, ?it/s]Collecting hidden states:   1%|          | 1/100 [00:01<02:31,  1.53s/it]Collecting hidden states:   2%|▏         | 2/100 [00:01<01:13,  1.34it/s]Collecting hidden states:   3%|▎         | 3/100 [00:02<00:52,  1.86it/s]Collecting hidden states:   4%|▍         | 4/100 [00:02<00:42,  2.26it/s]Collecting hidden states:   5%|▌         | 5/100 [00:02<00:33,  2.83it/s]Collecting hidden states:   6%|▌         | 6/100 [00:02<00:28,  3.31it/s]Collecting hidden states:   7%|▋         | 7/100 [00:03<00:34,  2.66it/s]Collecting hidden states:   8%|▊         | 8/100 [00:03<00:29,  3.14it/s]Collecting hidden states:   9%|▉         | 9/100 [00:03<00:33,  2.72it/s]Collecting hidden states:  10%|█         | 10/100 [00:04<00:29,  3.09it/s]Collecting hidden states:  11%|█         | 11/100 [00:04<00:29,  3.05it/s]Collecting hidden states:  12%|█▏        | 12/100 [00:04<00:27,  3.19it/s]Collecting hidden states:  13%|█▎        | 13/100 [00:05<00:30,  2.88it/s]Collecting hidden states:  14%|█▍        | 14/100 [00:05<00:24,  3.45it/s]Collecting hidden states:  15%|█▌        | 15/100 [00:05<00:21,  4.04it/s]Collecting hidden states:  16%|█▌        | 16/100 [00:05<00:23,  3.57it/s]Collecting hidden states:  17%|█▋        | 17/100 [00:06<00:26,  3.15it/s]Collecting hidden states:  18%|█▊        | 18/100 [00:06<00:25,  3.27it/s]Collecting hidden states:  19%|█▉        | 19/100 [00:06<00:24,  3.35it/s]Collecting hidden states:  20%|██        | 20/100 [00:07<00:24,  3.30it/s]Collecting hidden states:  21%|██        | 21/100 [00:07<00:25,  3.13it/s]Collecting hidden states:  22%|██▏       | 22/100 [00:07<00:25,  3.04it/s]Collecting hidden states:  23%|██▎       | 23/100 [00:08<00:22,  3.37it/s]Collecting hidden states:  24%|██▍       | 24/100 [00:08<00:29,  2.56it/s]Collecting hidden states:  25%|██▌       | 25/100 [00:08<00:25,  2.89it/s]Collecting hidden states:  26%|██▌       | 26/100 [00:09<00:41,  1.79it/s]Collecting hidden states:  27%|██▋       | 27/100 [00:10<00:32,  2.24it/s]Collecting hidden states:  28%|██▊       | 28/100 [00:10<00:30,  2.38it/s]Collecting hidden states:  29%|██▉       | 29/100 [00:10<00:25,  2.79it/s]Collecting hidden states:  30%|███       | 30/100 [00:10<00:22,  3.16it/s]Collecting hidden states:  31%|███       | 31/100 [00:11<00:23,  2.90it/s]Collecting hidden states:  32%|███▏      | 32/100 [00:11<00:20,  3.27it/s]Collecting hidden states:  33%|███▎      | 33/100 [00:11<00:21,  3.11it/s]Collecting hidden states:  34%|███▍      | 34/100 [00:12<00:23,  2.80it/s]Collecting hidden states:  35%|███▌      | 35/100 [00:12<00:19,  3.32it/s]Collecting hidden states:  36%|███▌      | 36/100 [00:12<00:22,  2.88it/s]Collecting hidden states:  37%|███▋      | 37/100 [00:13<00:21,  3.00it/s]Collecting hidden states:  38%|███▊      | 38/100 [00:13<00:21,  2.83it/s]Collecting hidden states:  39%|███▉      | 39/100 [00:14<00:27,  2.26it/s]Collecting hidden states:  40%|████      | 40/100 [00:14<00:22,  2.68it/s]Collecting hidden states:  41%|████      | 41/100 [00:14<00:20,  2.93it/s]Collecting hidden states:  42%|████▏     | 42/100 [00:15<00:23,  2.44it/s]Collecting hidden states:  43%|████▎     | 43/100 [00:15<00:20,  2.75it/s]Collecting hidden states:  44%|████▍     | 44/100 [00:16<00:20,  2.69it/s]Collecting hidden states:  45%|████▌     | 45/100 [00:16<00:27,  2.00it/s]Collecting hidden states:  46%|████▌     | 46/100 [00:17<00:31,  1.74it/s]Collecting hidden states:  47%|████▋     | 47/100 [00:17<00:24,  2.13it/s]Collecting hidden states:  48%|████▊     | 48/100 [00:18<00:20,  2.56it/s]Collecting hidden states:  49%|████▉     | 49/100 [00:18<00:19,  2.67it/s]Collecting hidden states:  50%|█████     | 50/100 [00:18<00:19,  2.52it/s]Collecting hidden states:  51%|█████     | 51/100 [00:19<00:19,  2.50it/s]Collecting hidden states:  52%|█████▏    | 52/100 [00:19<00:17,  2.82it/s]Collecting hidden states:  53%|█████▎    | 53/100 [00:19<00:15,  2.97it/s]Collecting hidden states:  54%|█████▍    | 54/100 [00:20<00:15,  2.88it/s]Collecting hidden states:  55%|█████▌    | 55/100 [00:20<00:16,  2.79it/s]Collecting hidden states:  56%|█████▌    | 56/100 [00:20<00:16,  2.69it/s]Collecting hidden states:  57%|█████▋    | 57/100 [00:21<00:16,  2.65it/s]Collecting hidden states:  58%|█████▊    | 58/100 [00:22<00:23,  1.78it/s]Collecting hidden states:  59%|█████▉    | 59/100 [00:22<00:18,  2.18it/s]Collecting hidden states:  60%|██████    | 60/100 [00:22<00:16,  2.37it/s]Collecting hidden states:  61%|██████    | 61/100 [00:23<00:14,  2.69it/s]Collecting hidden states:  62%|██████▏   | 62/100 [00:23<00:12,  3.03it/s]Collecting hidden states:  63%|██████▎   | 63/100 [00:23<00:13,  2.81it/s]Collecting hidden states:  64%|██████▍   | 64/100 [00:24<00:18,  1.96it/s]Collecting hidden states:  65%|██████▌   | 65/100 [00:24<00:15,  2.26it/s]Collecting hidden states:  66%|██████▌   | 66/100 [00:25<00:12,  2.71it/s]Collecting hidden states:  67%|██████▋   | 67/100 [00:25<00:10,  3.16it/s]Collecting hidden states:  68%|██████▊   | 68/100 [00:25<00:08,  3.64it/s]Collecting hidden states:  69%|██████▉   | 69/100 [00:25<00:08,  3.67it/s]Collecting hidden states:  70%|███████   | 70/100 [00:25<00:07,  3.78it/s]Collecting hidden states:  71%|███████   | 71/100 [00:26<00:07,  3.78it/s]Collecting hidden states:  72%|███████▏  | 72/100 [00:26<00:08,  3.26it/s]Collecting hidden states:  73%|███████▎  | 73/100 [00:26<00:07,  3.51it/s]Collecting hidden states:  74%|███████▍  | 74/100 [00:27<00:08,  3.18it/s]Collecting hidden states:  75%|███████▌  | 75/100 [00:28<00:14,  1.78it/s]Collecting hidden states:  76%|███████▌  | 76/100 [00:28<00:12,  1.92it/s]Collecting hidden states:  77%|███████▋  | 77/100 [00:29<00:13,  1.76it/s]Collecting hidden states:  78%|███████▊  | 78/100 [00:29<00:10,  2.07it/s]Collecting hidden states:  79%|███████▉  | 79/100 [00:30<00:08,  2.44it/s]Collecting hidden states:  80%|████████  | 80/100 [00:30<00:07,  2.65it/s]Collecting hidden states:  81%|████████  | 81/100 [00:30<00:06,  2.82it/s]Collecting hidden states:  82%|████████▏ | 82/100 [00:30<00:06,  2.97it/s]Collecting hidden states:  83%|████████▎ | 83/100 [00:31<00:05,  3.06it/s]Collecting hidden states:  84%|████████▍ | 84/100 [00:31<00:05,  3.18it/s]Collecting hidden states:  85%|████████▌ | 85/100 [00:31<00:03,  3.86it/s]Collecting hidden states:  86%|████████▌ | 86/100 [00:32<00:04,  3.33it/s]Collecting hidden states:  87%|████████▋ | 87/100 [00:32<00:03,  3.52it/s]Collecting hidden states:  88%|████████▊ | 88/100 [00:32<00:03,  3.05it/s]Collecting hidden states:  89%|████████▉ | 89/100 [00:32<00:03,  3.22it/s]Collecting hidden states:  90%|█████████ | 90/100 [00:33<00:03,  3.26it/s]Collecting hidden states:  91%|█████████ | 91/100 [00:33<00:02,  3.10it/s]Collecting hidden states:  92%|█████████▏| 92/100 [00:33<00:02,  3.54it/s]Collecting hidden states:  93%|█████████▎| 93/100 [00:34<00:03,  2.30it/s]Collecting hidden states:  94%|█████████▍| 94/100 [00:34<00:02,  2.71it/s]Collecting hidden states:  95%|█████████▌| 95/100 [00:35<00:01,  3.14it/s]Collecting hidden states:  96%|█████████▌| 96/100 [00:35<00:01,  3.02it/s]Collecting hidden states:  97%|█████████▋| 97/100 [00:36<00:01,  2.36it/s]Collecting hidden states:  98%|█████████▊| 98/100 [00:36<00:00,  2.62it/s]Collecting hidden states:  99%|█████████▉| 99/100 [00:36<00:00,  2.49it/s]Collecting hidden states: 100%|██████████| 100/100 [00:36<00:00,  2.93it/s]Collecting hidden states: 100%|██████████| 100/100 [00:36<00:00,  2.70it/s]
2025-12-11 23:59:29,139 | INFO | Collected 100 correct embeddings (shape: (100, 4096))
2025-12-11 23:59:29,140 | INFO | Collecting wrong embeddings without steering (prompt only)...
Collecting hidden states:   0%|          | 0/100 [00:00<?, ?it/s]Collecting hidden states:   1%|          | 1/100 [00:00<00:25,  3.87it/s]Collecting hidden states:   2%|▏         | 2/100 [00:00<00:18,  5.38it/s]Collecting hidden states:   3%|▎         | 3/100 [00:00<00:22,  4.37it/s]Collecting hidden states:   4%|▍         | 4/100 [00:00<00:22,  4.32it/s]Collecting hidden states:   5%|▌         | 5/100 [00:01<00:18,  5.09it/s]Collecting hidden states:   6%|▌         | 6/100 [00:01<00:16,  5.69it/s]Collecting hidden states:   7%|▋         | 7/100 [00:01<00:21,  4.37it/s]Collecting hidden states:   8%|▊         | 8/100 [00:01<00:18,  5.11it/s]Collecting hidden states:   9%|▉         | 9/100 [00:01<00:17,  5.07it/s]Collecting hidden states:  10%|█         | 10/100 [00:01<00:16,  5.49it/s]Collecting hidden states:  11%|█         | 11/100 [00:02<00:15,  5.75it/s]Collecting hidden states:  12%|█▏        | 12/100 [00:02<00:14,  6.08it/s]Collecting hidden states:  13%|█▎        | 13/100 [00:02<00:14,  5.96it/s]Collecting hidden states:  14%|█▍        | 14/100 [00:02<00:13,  6.25it/s]Collecting hidden states:  16%|█▌        | 16/100 [00:02<00:14,  6.00it/s]Collecting hidden states:  17%|█▋        | 17/100 [00:03<00:15,  5.26it/s]Collecting hidden states:  18%|█▊        | 18/100 [00:03<00:15,  5.44it/s]Collecting hidden states:  19%|█▉        | 19/100 [00:03<00:14,  5.41it/s]Collecting hidden states:  20%|██        | 20/100 [00:03<00:16,  4.73it/s]Collecting hidden states:  21%|██        | 21/100 [00:04<00:15,  5.06it/s]Collecting hidden states:  22%|██▏       | 22/100 [00:04<00:14,  5.39it/s]Collecting hidden states:  23%|██▎       | 23/100 [00:04<00:14,  5.40it/s]Collecting hidden states:  24%|██▍       | 24/100 [00:04<00:14,  5.36it/s]Collecting hidden states:  25%|██▌       | 25/100 [00:04<00:13,  5.54it/s]Collecting hidden states:  26%|██▌       | 26/100 [00:05<00:20,  3.59it/s]Collecting hidden states:  27%|██▋       | 27/100 [00:05<00:18,  3.94it/s]Collecting hidden states:  28%|██▊       | 28/100 [00:05<00:18,  3.91it/s]Collecting hidden states:  29%|██▉       | 29/100 [00:05<00:16,  4.21it/s]Collecting hidden states:  30%|███       | 30/100 [00:06<00:14,  4.73it/s]Collecting hidden states:  31%|███       | 31/100 [00:06<00:14,  4.70it/s]Collecting hidden states:  32%|███▏      | 32/100 [00:06<00:14,  4.85it/s]Collecting hidden states:  33%|███▎      | 33/100 [00:06<00:16,  4.17it/s]Collecting hidden states:  34%|███▍      | 34/100 [00:06<00:15,  4.32it/s]Collecting hidden states:  35%|███▌      | 35/100 [00:07<00:13,  4.93it/s]Collecting hidden states:  36%|███▌      | 36/100 [00:07<00:12,  5.31it/s]Collecting hidden states:  37%|███▋      | 37/100 [00:07<00:11,  5.43it/s]Collecting hidden states:  38%|███▊      | 38/100 [00:07<00:11,  5.58it/s]Collecting hidden states:  39%|███▉      | 39/100 [00:07<00:11,  5.21it/s]Collecting hidden states:  40%|████      | 40/100 [00:07<00:11,  5.31it/s]Collecting hidden states:  41%|████      | 41/100 [00:08<00:11,  5.17it/s]Collecting hidden states:  42%|████▏     | 42/100 [00:08<00:12,  4.77it/s]Collecting hidden states:  43%|████▎     | 43/100 [00:08<00:11,  4.96it/s]Collecting hidden states:  44%|████▍     | 44/100 [00:08<00:11,  4.95it/s]Collecting hidden states:  45%|████▌     | 45/100 [00:09<00:11,  4.59it/s]Collecting hidden states:  46%|████▌     | 46/100 [00:09<00:11,  4.57it/s]Collecting hidden states:  47%|████▋     | 47/100 [00:09<00:10,  5.16it/s]Collecting hidden states:  49%|████▉     | 49/100 [00:09<00:09,  5.30it/s]Collecting hidden states:  50%|█████     | 50/100 [00:10<00:10,  4.57it/s]Collecting hidden states:  51%|█████     | 51/100 [00:10<00:10,  4.69it/s]Collecting hidden states:  52%|█████▏    | 52/100 [00:10<00:09,  5.00it/s]Collecting hidden states:  53%|█████▎    | 53/100 [00:10<00:09,  5.07it/s]Collecting hidden states:  54%|█████▍    | 54/100 [00:10<00:08,  5.39it/s]Collecting hidden states:  55%|█████▌    | 55/100 [00:10<00:07,  5.87it/s]Collecting hidden states:  56%|█████▌    | 56/100 [00:11<00:09,  4.56it/s]Collecting hidden states:  57%|█████▋    | 57/100 [00:11<00:10,  4.05it/s]Collecting hidden states:  58%|█████▊    | 58/100 [00:11<00:09,  4.29it/s]Collecting hidden states:  59%|█████▉    | 59/100 [00:12<00:09,  4.15it/s]Collecting hidden states:  60%|██████    | 60/100 [00:12<00:09,  4.14it/s]Collecting hidden states:  61%|██████    | 61/100 [00:12<00:08,  4.63it/s]Collecting hidden states:  62%|██████▏   | 62/100 [00:12<00:07,  4.96it/s]Collecting hidden states:  63%|██████▎   | 63/100 [00:12<00:07,  4.96it/s]Collecting hidden states:  64%|██████▍   | 64/100 [00:12<00:06,  5.27it/s]Collecting hidden states:  65%|██████▌   | 65/100 [00:13<00:06,  5.39it/s]Collecting hidden states:  66%|██████▌   | 66/100 [00:13<00:06,  5.55it/s]Collecting hidden states:  67%|██████▋   | 67/100 [00:13<00:05,  5.72it/s]Collecting hidden states:  68%|██████▊   | 68/100 [00:13<00:05,  5.79it/s]Collecting hidden states:  69%|██████▉   | 69/100 [00:13<00:05,  6.03it/s]Collecting hidden states:  70%|███████   | 70/100 [00:13<00:04,  6.23it/s]Collecting hidden states:  71%|███████   | 71/100 [00:14<00:04,  6.27it/s]Collecting hidden states:  72%|███████▏  | 72/100 [00:14<00:06,  4.56it/s]Collecting hidden states:  73%|███████▎  | 73/100 [00:14<00:05,  4.82it/s]Collecting hidden states:  74%|███████▍  | 74/100 [00:14<00:05,  4.53it/s]Collecting hidden states:  75%|███████▌  | 75/100 [00:15<00:07,  3.31it/s]Collecting hidden states:  76%|███████▌  | 76/100 [00:15<00:07,  3.31it/s]Collecting hidden states:  77%|███████▋  | 77/100 [00:15<00:06,  3.82it/s]Collecting hidden states:  78%|███████▊  | 78/100 [00:16<00:05,  4.02it/s]Collecting hidden states:  79%|███████▉  | 79/100 [00:16<00:04,  4.30it/s]Collecting hidden states:  80%|████████  | 80/100 [00:16<00:04,  4.54it/s]Collecting hidden states:  81%|████████  | 81/100 [00:16<00:04,  4.49it/s]Collecting hidden states:  82%|████████▏ | 82/100 [00:16<00:04,  4.33it/s]Collecting hidden states:  83%|████████▎ | 83/100 [00:17<00:03,  4.98it/s]Collecting hidden states:  84%|████████▍ | 84/100 [00:17<00:03,  4.84it/s]Collecting hidden states:  85%|████████▌ | 85/100 [00:17<00:02,  5.34it/s]Collecting hidden states:  86%|████████▌ | 86/100 [00:17<00:03,  4.49it/s]Collecting hidden states:  87%|████████▋ | 87/100 [00:17<00:02,  5.07it/s]Collecting hidden states:  88%|████████▊ | 88/100 [00:18<00:02,  4.41it/s]Collecting hidden states:  89%|████████▉ | 89/100 [00:18<00:02,  4.29it/s]Collecting hidden states:  90%|█████████ | 90/100 [00:18<00:02,  4.22it/s]Collecting hidden states:  91%|█████████ | 91/100 [00:18<00:01,  4.55it/s]Collecting hidden states:  92%|█████████▏| 92/100 [00:18<00:01,  5.21it/s]Collecting hidden states:  93%|█████████▎| 93/100 [00:19<00:01,  3.54it/s]Collecting hidden states:  94%|█████████▍| 94/100 [00:19<00:01,  4.21it/s]Collecting hidden states:  95%|█████████▌| 95/100 [00:19<00:01,  4.56it/s]Collecting hidden states:  96%|█████████▌| 96/100 [00:20<00:00,  4.22it/s]Collecting hidden states:  97%|█████████▋| 97/100 [00:20<00:00,  4.82it/s]Collecting hidden states:  98%|█████████▊| 98/100 [00:20<00:00,  5.40it/s]Collecting hidden states:  99%|█████████▉| 99/100 [00:20<00:00,  4.66it/s]Collecting hidden states: 100%|██████████| 100/100 [00:20<00:00,  5.22it/s]Collecting hidden states: 100%|██████████| 100/100 [00:20<00:00,  4.81it/s]
2025-12-11 23:59:49,910 | INFO | Collected 100 wrong embeddings without steering (shape: (100, 4096))
2025-12-11 23:59:49,910 | INFO | Collecting wrong embeddings with steering (simulated by adding steering vector)...
Collecting hidden states:   0%|          | 0/100 [00:00<?, ?it/s]Collecting hidden states:   1%|          | 1/100 [00:00<00:23,  4.25it/s]Collecting hidden states:   2%|▏         | 2/100 [00:00<00:16,  5.83it/s]Collecting hidden states:   3%|▎         | 3/100 [00:00<00:21,  4.57it/s]Collecting hidden states:   4%|▍         | 4/100 [00:00<00:22,  4.28it/s]Collecting hidden states:   5%|▌         | 5/100 [00:01<00:19,  4.91it/s]Collecting hidden states:   6%|▌         | 6/100 [00:01<00:16,  5.58it/s]Collecting hidden states:   7%|▋         | 7/100 [00:01<00:20,  4.59it/s]Collecting hidden states:   9%|▉         | 9/100 [00:01<00:15,  5.89it/s]Collecting hidden states:  10%|█         | 10/100 [00:01<00:14,  6.09it/s]Collecting hidden states:  11%|█         | 11/100 [00:02<00:14,  6.18it/s]Collecting hidden states:  12%|█▏        | 12/100 [00:02<00:13,  6.41it/s]Collecting hidden states:  13%|█▎        | 13/100 [00:02<00:13,  6.34it/s]Collecting hidden states:  14%|█▍        | 14/100 [00:02<00:13,  6.47it/s]Collecting hidden states:  15%|█▌        | 15/100 [00:02<00:12,  6.97it/s]Collecting hidden states:  16%|█▌        | 16/100 [00:02<00:15,  5.52it/s]Collecting hidden states:  17%|█▋        | 17/100 [00:03<00:15,  5.19it/s]Collecting hidden states:  18%|█▊        | 18/100 [00:03<00:15,  5.44it/s]Collecting hidden states:  19%|█▉        | 19/100 [00:03<00:14,  5.75it/s]Collecting hidden states:  20%|██        | 20/100 [00:03<00:15,  5.07it/s]Collecting hidden states:  21%|██        | 21/100 [00:03<00:14,  5.33it/s]Collecting hidden states:  22%|██▏       | 22/100 [00:03<00:13,  5.58it/s]Collecting hidden states:  23%|██▎       | 23/100 [00:04<00:13,  5.89it/s]Collecting hidden states:  24%|██▍       | 24/100 [00:04<00:13,  5.75it/s]Collecting hidden states:  25%|██▌       | 25/100 [00:04<00:12,  5.80it/s]Collecting hidden states:  26%|██▌       | 26/100 [00:05<00:21,  3.42it/s]Collecting hidden states:  27%|██▋       | 27/100 [00:05<00:19,  3.79it/s]Collecting hidden states:  28%|██▊       | 28/100 [00:05<00:18,  3.80it/s]Collecting hidden states:  29%|██▉       | 29/100 [00:05<00:16,  4.27it/s]Collecting hidden states:  30%|███       | 30/100 [00:05<00:14,  4.84it/s]Collecting hidden states:  31%|███       | 31/100 [00:05<00:13,  5.18it/s]Collecting hidden states:  32%|███▏      | 32/100 [00:06<00:12,  5.25it/s]Collecting hidden states:  33%|███▎      | 33/100 [00:06<00:15,  4.21it/s]Collecting hidden states:  34%|███▍      | 34/100 [00:06<00:16,  4.09it/s]Collecting hidden states:  35%|███▌      | 35/100 [00:06<00:14,  4.56it/s]Collecting hidden states:  36%|███▌      | 36/100 [00:07<00:13,  4.76it/s]Collecting hidden states:  37%|███▋      | 37/100 [00:07<00:12,  5.06it/s]Collecting hidden states:  38%|███▊      | 38/100 [00:07<00:11,  5.32it/s]Collecting hidden states:  39%|███▉      | 39/100 [00:07<00:12,  4.75it/s]Collecting hidden states:  40%|████      | 40/100 [00:07<00:11,  5.23it/s]Collecting hidden states:  41%|████      | 41/100 [00:07<00:10,  5.61it/s]Collecting hidden states:  42%|████▏     | 42/100 [00:08<00:11,  5.11it/s]Collecting hidden states:  43%|████▎     | 43/100 [00:08<00:10,  5.41it/s]Collecting hidden states:  44%|████▍     | 44/100 [00:08<00:10,  5.39it/s]Collecting hidden states:  45%|████▌     | 45/100 [00:08<00:10,  5.11it/s]Collecting hidden states:  46%|████▌     | 46/100 [00:09<00:10,  5.00it/s]Collecting hidden states:  47%|████▋     | 47/100 [00:09<00:09,  5.60it/s]Collecting hidden states:  48%|████▊     | 48/100 [00:09<00:08,  6.22it/s]Collecting hidden states:  49%|████▉     | 49/100 [00:09<00:09,  5.11it/s]Collecting hidden states:  50%|█████     | 50/100 [00:09<00:11,  4.42it/s]Collecting hidden states:  51%|█████     | 51/100 [00:10<00:10,  4.53it/s]Collecting hidden states:  52%|█████▏    | 52/100 [00:10<00:09,  4.80it/s]Collecting hidden states:  53%|█████▎    | 53/100 [00:10<00:09,  4.85it/s]Collecting hidden states:  54%|█████▍    | 54/100 [00:10<00:09,  4.82it/s]Collecting hidden states:  55%|█████▌    | 55/100 [00:10<00:08,  5.17it/s]Collecting hidden states:  56%|█████▌    | 56/100 [00:11<00:10,  4.25it/s]Collecting hidden states:  57%|█████▋    | 57/100 [00:11<00:11,  3.63it/s]Collecting hidden states:  58%|█████▊    | 58/100 [00:11<00:10,  3.90it/s]Collecting hidden states:  59%|█████▉    | 59/100 [00:11<00:10,  4.02it/s]Collecting hidden states:  60%|██████    | 60/100 [00:12<00:10,  3.94it/s]Collecting hidden states:  61%|██████    | 61/100 [00:12<00:09,  4.17it/s]Collecting hidden states:  62%|██████▏   | 62/100 [00:12<00:08,  4.35it/s]Collecting hidden states:  63%|██████▎   | 63/100 [00:12<00:08,  4.52it/s]Collecting hidden states:  64%|██████▍   | 64/100 [00:13<00:07,  4.57it/s]Collecting hidden states:  65%|██████▌   | 65/100 [00:13<00:06,  5.06it/s]Collecting hidden states:  66%|██████▌   | 66/100 [00:13<00:06,  5.29it/s]Collecting hidden states:  67%|██████▋   | 67/100 [00:13<00:05,  5.89it/s]Collecting hidden states:  68%|██████▊   | 68/100 [00:13<00:05,  6.25it/s]Collecting hidden states:  69%|██████▉   | 69/100 [00:13<00:04,  6.24it/s]Collecting hidden states:  70%|███████   | 70/100 [00:13<00:04,  6.02it/s]Collecting hidden states:  71%|███████   | 71/100 [00:14<00:04,  6.00it/s]Collecting hidden states:  72%|███████▏  | 72/100 [00:14<00:06,  4.50it/s]Collecting hidden states:  73%|███████▎  | 73/100 [00:14<00:05,  4.61it/s]Collecting hidden states:  74%|███████▍  | 74/100 [00:14<00:06,  4.30it/s]Collecting hidden states:  75%|███████▌  | 75/100 [00:15<00:07,  3.47it/s]Collecting hidden states:  76%|███████▌  | 76/100 [00:15<00:07,  3.19it/s]Collecting hidden states:  77%|███████▋  | 77/100 [00:15<00:05,  3.84it/s]Collecting hidden states:  78%|███████▊  | 78/100 [00:16<00:05,  3.99it/s]Collecting hidden states:  79%|███████▉  | 79/100 [00:16<00:04,  4.23it/s]Collecting hidden states:  80%|████████  | 80/100 [00:16<00:04,  4.71it/s]Collecting hidden states:  81%|████████  | 81/100 [00:16<00:04,  4.62it/s]Collecting hidden states:  82%|████████▏ | 82/100 [00:16<00:04,  4.32it/s]Collecting hidden states:  83%|████████▎ | 83/100 [00:17<00:03,  4.94it/s]Collecting hidden states:  84%|████████▍ | 84/100 [00:17<00:03,  4.70it/s]Collecting hidden states:  85%|████████▌ | 85/100 [00:17<00:03,  4.97it/s]Collecting hidden states:  86%|████████▌ | 86/100 [00:17<00:03,  4.20it/s]Collecting hidden states:  87%|████████▋ | 87/100 [00:17<00:02,  4.85it/s]Collecting hidden states:  88%|████████▊ | 88/100 [00:18<00:02,  4.25it/s]Collecting hidden states:  89%|████████▉ | 89/100 [00:18<00:02,  4.18it/s]Collecting hidden states:  90%|█████████ | 90/100 [00:18<00:02,  4.21it/s]Collecting hidden states:  91%|█████████ | 91/100 [00:18<00:01,  4.70it/s]Collecting hidden states:  93%|█████████▎| 93/100 [00:19<00:01,  3.88it/s]Collecting hidden states:  94%|█████████▍| 94/100 [00:19<00:01,  4.44it/s]Collecting hidden states:  95%|█████████▌| 95/100 [00:19<00:01,  4.96it/s]Collecting hidden states:  96%|█████████▌| 96/100 [00:20<00:00,  4.76it/s]Collecting hidden states:  97%|█████████▋| 97/100 [00:20<00:00,  5.26it/s]Collecting hidden states:  98%|█████████▊| 98/100 [00:20<00:00,  5.36it/s]Collecting hidden states:  99%|█████████▉| 99/100 [00:20<00:00,  4.74it/s]Collecting hidden states: 100%|██████████| 100/100 [00:20<00:00,  5.20it/s]Collecting hidden states: 100%|██████████| 100/100 [00:20<00:00,  4.82it/s]
2025-12-12 00:00:10,653 | INFO | Collected 100 wrong embeddings with steering (shape: (100, 4096))
2025-12-12 00:00:10,707 | INFO | Shift statistics:
2025-12-12 00:00:10,707 | INFO |   Steering shift - Mean L2: 3.6889
2025-12-12 00:00:10,708 | INFO |   Distance to correct (before) - Mean L2: 5.7891
2025-12-12 00:00:10,708 | INFO |   Distance to correct (after) - Mean L2: 7.2843
2025-12-12 00:00:10,708 | INFO |   Improvement - Mean L2 reduction: -1.4961
2025-12-12 00:00:10,708 | INFO | Advanced Metrics:
2025-12-12 00:00:10,708 | INFO |   Projected Shift (Useful):   -0.4704
2025-12-12 00:00:10,708 | INFO |   Orthogonal Shift (Useless): 3.6588
2025-12-12 00:00:10,708 | INFO |   Shift Ratio (Proj/Total):   0.1275
2025-12-12 00:00:10,708 | INFO |   Recovery Score:             -0.3789 (1.0 = perfect, 0.0 = no change)
2025-12-12 00:00:10,708 | INFO |   Positive Recovery %:        0.0%
2025-12-12 00:00:10,709 | INFO | Saved statistics to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_out_of_sample/layer29_shift_statistics_offset100.json
2025-12-12 00:00:10,709 | INFO | Creating visualizations...
2025-12-12 00:00:11,624 | INFO | Saved comparison plot to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_out_of_sample/layer29_pca_comparison_offset100.png
2025-12-12 00:00:12,121 | INFO | Saved overlay plot to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_out_of_sample/layer29_pca_overlay_offset100.png
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/numba/np/ufunc/parallel.py:373: NumbaWarning: The TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.
  warnings.warn(problem)
2025-12-12 00:00:23,990 | INFO | Saved comparison plot to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_out_of_sample/layer29_umap_comparison_offset100.png
/u/b/d/bdeka/miniconda3/envs/steering/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
2025-12-12 00:00:29,930 | INFO | Saved overlay plot to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_out_of_sample/layer29_umap_overlay_offset100.png
2025-12-12 00:00:29,930 | INFO | All visualizations saved to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_out_of_sample
Embedding comparison complete. Results saved to /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_in_sample and /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_out_of_sample

=== Done! ===
Results:
  - Triples source: ./artifacts/manual_review/12062025_human_review.json
  - Train offset: 0, Eval offset: 100
  - Hidden states: /nobackup/bdeka/huggingface_cache/artifacts/hidden_states/
  - Alignments: /nobackup/bdeka/huggingface_cache/artifacts/alignments/
  - Probe data: /nobackup/bdeka/huggingface_cache/artifacts/probe_data/
  - Computed probes: /nobackup/bdeka/huggingface_cache/artifacts/probe_analysis/
  - Visualizations: /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token/
  - Steering vectors: /nobackup/bdeka/huggingface_cache/artifacts/steering_vectors/
  - Steering evaluation (in-sample): /nobackup/bdeka/huggingface_cache/artifacts/steering_evaluation_in_sample/
  - Steering evaluation (out-of-sample): /nobackup/bdeka/huggingface_cache/artifacts/steering_evaluation_out_of_sample/
  - Embedding comparison (in-sample): /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_in_sample/
  - Embedding comparison (out-of-sample): /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_out_of_sample/

Processed layers: 26 27 28 29 30 31
    Extracted HF_HOME from log output path: /nobackup/bdeka/huggingface_cache
    Using HF_HOME: /nobackup/bdeka/huggingface_cache
    Creating HF_HOME images directory: /nobackup/bdeka/huggingface_cache/experiments/20251211_144418/POOLING_METHOD_per_token__TOKEN_SELECTION_METHOD_dp_average__LAYER_SELECTION_METHOD_fixed__SKIP_HIDDEN_1__SKIP_PROBES_1__SKIP_PLOTS_0__SKIP_CRITICAL_1__SKIP_STEERING_0__SKIP_EVAL_0/images
    ✓ Successfully created HF_HOME images directory: /nobackup/bdeka/huggingface_cache/experiments/20251211_144418/POOLING_METHOD_per_token__TOKEN_SELECTION_METHOD_dp_average__LAYER_SELECTION_METHOD_fixed__SKIP_HIDDEN_1__SKIP_PROBES_1__SKIP_PLOTS_0__SKIP_CRITICAL_1__SKIP_STEERING_0__SKIP_EVAL_0/images

=== Copying generated images to experiment directory ===
  Copying generated images to:
    Local: experiments/20251211_144418/POOLING_METHOD_per_token__TOKEN_SELECTION_METHOD_dp_average__LAYER_SELECTION_METHOD_fixed__SKIP_HIDDEN_1__SKIP_PROBES_1__SKIP_PLOTS_0__SKIP_CRITICAL_1__SKIP_STEERING_0__SKIP_EVAL_0/images
    HF_HOME: /nobackup/bdeka/huggingface_cache/experiments/20251211_144418/POOLING_METHOD_per_token__TOKEN_SELECTION_METHOD_dp_average__LAYER_SELECTION_METHOD_fixed__SKIP_HIDDEN_1__SKIP_PROBES_1__SKIP_PLOTS_0__SKIP_CRITICAL_1__SKIP_STEERING_0__SKIP_EVAL_0/images
    Source HF_HOME: /nobackup/bdeka/huggingface_cache
    Checking for Step 4 images in: /nobackup/bdeka/huggingface_cache/reports/hidden_state_viz_per_token
    ✓ Copied 12 image(s) from Step 4 (probe visualizations)
    Checking for Step 5 images in: /nobackup/bdeka/huggingface_cache/reports/critical_tokens_per_token
    ✓ Copied 6 image(s) from Step 5 (critical tokens)
    Checking for Step 8 images in:
      HF_HOME: /nobackup/bdeka/huggingface_cache
      In-sample dir: /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_in_sample
      Out-of-sample dir: /nobackup/bdeka/huggingface_cache/reports/steering_embedding_comparison_out_of_sample
    ✓ Copied 4 image(s) from Step 8 (embedding comparison in-sample)
    ✓ Copied 4 image(s) from Step 8 (embedding comparison out-of-sample)
  ✓ Copied 26 total image(s) to:
    - Local: experiments/20251211_144418/POOLING_METHOD_per_token__TOKEN_SELECTION_METHOD_dp_average__LAYER_SELECTION_METHOD_fixed__SKIP_HIDDEN_1__SKIP_PROBES_1__SKIP_PLOTS_0__SKIP_CRITICAL_1__SKIP_STEERING_0__SKIP_EVAL_0/images/
    - HF_HOME: /nobackup/bdeka/huggingface_cache/experiments/20251211_144418/POOLING_METHOD_per_token__TOKEN_SELECTION_METHOD_dp_average__LAYER_SELECTION_METHOD_fixed__SKIP_HIDDEN_1__SKIP_PROBES_1__SKIP_PLOTS_0__SKIP_CRITICAL_1__SKIP_STEERING_0__SKIP_EVAL_0/images/
